{"meta":{"title":"Fantasyçš„ä¸ªäººåšå®¢","subtitle":null,"description":null,"author":"Fantasy","url":"http://yoursite.com"},"pages":[],"posts":[{"title":"LaLaå¿ƒç†å­¦éŸ³ä¹ä¼š","slug":"LaLaå¿ƒç†å­¦éŸ³ä¹ä¼š","date":"2018-03-18T15:05:06.000Z","updated":"2018-03-18T15:41:01.000Z","comments":true,"path":"2018/03/18/LaLaå¿ƒç†å­¦éŸ³ä¹ä¼š/","link":"","permalink":"http://yoursite.com/2018/03/18/LaLaå¿ƒç†å­¦éŸ³ä¹ä¼š/","excerpt":"ä¸Šå‘¨æ— èŠæ‰“å¼€äº†å¤§éº¦ç½‘ï¼Œå‘ç°æœ‰å¾ä½³è¹çš„éŸ³ä¹ä¼šè€¶ï¼Œç¥¨ä¸è´µï¼Œèµ¶ç´§å…¥æ‰‹äº†ä¸€å¼ ã€‚ è®°å¾—æœ€æ—©å¬å¥¹æ˜¯é‚£å¼ ã€Šå¯»äººå¯äº‹ã€‹ï¼Œä¸€ä¸ªå‡ ä¹æ²¡åæ°”çš„æ–°äººï¼Œç›´æ¥æ‹¿åˆ°ä¸ª6ä¸ªé‡‘æ›²å¥–çš„æåã€‚é‡‘æ›²å¥–è™½ç„¶æœ‰å¾ˆå¤šè¯Ÿç—…çš„åœ°æ–¹ï¼Œä½†ä¸€ç›´è¿˜æ˜¯å¾ˆå–œæ¬¢å®ƒçš„å“å‘³çš„ï¼Œæ¯å¹´éƒ½èƒ½å‘æ˜å‡ºä¸€æ‰¹ä¸å‡ºåï¼Œä½†å¾ˆä¼˜ç§€çš„ä½œå“ã€‚","text":"ä¸Šå‘¨æ— èŠæ‰“å¼€äº†å¤§éº¦ç½‘ï¼Œå‘ç°æœ‰å¾ä½³è¹çš„éŸ³ä¹ä¼šè€¶ï¼Œç¥¨ä¸è´µï¼Œèµ¶ç´§å…¥æ‰‹äº†ä¸€å¼ ã€‚ è®°å¾—æœ€æ—©å¬å¥¹æ˜¯é‚£å¼ ã€Šå¯»äººå¯äº‹ã€‹ï¼Œä¸€ä¸ªå‡ ä¹æ²¡åæ°”çš„æ–°äººï¼Œç›´æ¥æ‹¿åˆ°ä¸ª6ä¸ªé‡‘æ›²å¥–çš„æåã€‚é‡‘æ›²å¥–è™½ç„¶æœ‰å¾ˆå¤šè¯Ÿç—…çš„åœ°æ–¹ï¼Œä½†ä¸€ç›´è¿˜æ˜¯å¾ˆå–œæ¬¢å®ƒçš„å“å‘³çš„ï¼Œæ¯å¹´éƒ½èƒ½å‘æ˜å‡ºä¸€æ‰¹ä¸å‡ºåï¼Œä½†å¾ˆä¼˜ç§€çš„ä½œå“ã€‚Lalaçš„æ­Œèµ°çš„æ˜¯èµ°å¿ƒçš„è·¯çº¿ï¼Œé€‚åˆä¸€ä¸ªäººå®‰é™æ—¶æ…¢æ…¢çš„å¬ï¼Œæ¯”å¦‚å¤±è½æ²™æ´²å’Œå¯»äººå¯äº‹ï¼Œå½“æ—¶æ„Ÿè§‰å‘ç°äº†ä¸ªå®ï¼Œå¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½åœ¨å¾ªç¯ç€æ—©æœŸçš„å››å¼ ä¸“è¾‘ã€‚ åæ¥ä¸Šäº†æˆ‘æ˜¯æ­Œæ‰‹ï¼Œæ…¢æ…¢çš„ä¹Ÿè¢«äººç†ŸçŸ¥ï¼Œè®°å¾—é¦–åœºè¿˜æ‹¿äº†ç¬¬ä¸€ï¼Œé‚£æ—¶æ¯æœŸéƒ½çœ‹ã€‚ä½œä¸ºåŸåˆ›æ­Œæ‰‹ï¼Œè¿™ç‚¹å’Œæ°ä¼¦æœ‰ç‚¹åƒï¼Œæ¼”ç»çš„æ˜¯åˆ«äººçš„æ­Œæ›²ï¼Œä½†æœ€åæ¼”ç»çš„éƒ½æˆè‡ªå·±çš„å•¦ã€‚å¯¹äºè¿™ç±»æ­Œæ‰‹ï¼Œä¼°è®¡åŸå”±å†…å¿ƒæ˜¯æ‹’ç»çš„å“ˆğŸ˜†ã€‚æ­Œæ‰‹ä¸Šè®°å¿†å¾ˆæ·±çš„æœ‰ã€Šæµªè´¹ã€‹ã€Šæˆ‘å¥½æƒ³ä½ ã€‹ ã€Šä¿®ç‚¼çˆ±æƒ…ã€‹ ã€Šè‰è‰å®‰ã€‹ ã€Šç›¸çˆ±ååŠ¨ç‰©æ„Ÿä¼¤ã€‹ã€‚ åæ¥å¬çš„å€’è¶Šæ¥è¶Šå°‘å•¦ï¼Œä½†å…³æ³¨äº†ç½‘æ˜“äº‘éŸ³ä¹ï¼Œæ¯æ¬¡å‡ºæ–°æ­Œæ–°MVéƒ½ä¼šæœ‰æ¨é€ï¼Œæ¯é¦–éƒ½ä¼šå¬çš„ï¼Œå‡ºååçš„LaLaè®²çœŸè¿˜æ˜¯å’ŒåŸå…ˆå·®ä¸å¤šï¼Œè¿™å¯èƒ½ä¹Ÿæ³¨å®šäº†å¥¹ä¸ä¼šå¤ªçº¢ã€‚ä½†è¿™ç±»æ­Œæ‰‹ï¼Œå–œæ¬¢å¥¹çš„ä¼šä¸€ç›´å–œæ¬¢ç€ã€‚ éŸ³ä¹ä¼šæœç„¶å’Œæ¼”å”±ä¼šä¸åŒï¼Œåªä¸€ä¸ªå°æ—¶å¤šä¸€ç‚¹ï¼Œå®Œå…¨æ²¡å¬å¤Ÿï¼Œå¸Œæœ›ä¸‹æ¬¡èƒ½å¤Ÿå¬åœºå¥¹çš„æ¼”å”±ä¼šã€‚","categories":[],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yoursite.com/tags/éšç¬”/"}]},{"title":"tornadoæºç å­¦ä¹ ç¬”è®°","slug":"tornadoæºç å­¦ä¹ ç¬”è®°","date":"2017-03-16T13:31:14.000Z","updated":"2018-03-16T14:08:00.000Z","comments":true,"path":"2017/03/16/tornadoæºç å­¦ä¹ ç¬”è®°/","link":"","permalink":"http://yoursite.com/2017/03/16/tornadoæºç å­¦ä¹ ç¬”è®°/","excerpt":"yieldç”¨æ³•åœ¨pythonä¸­ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°é‡Œé¢å«æœ‰yieldè¯­å¥ï¼Œé‚£ä¹ˆè°ƒç”¨å‡½æ•°ï¼Œè¿”å›çš„ä¸æ˜¯å‡½æ•°çš„returnç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ã€‚ä¹‹åè¿›è¡Œæ“ä½œèƒ½å°†è¿™ä¸ªå‡½æ•°è¿”å›ä¸­é—´ç»“æœç»™è°ƒç”¨è€…ï¼Œç„¶åç»´æŠ¤å‡½æ•°çš„å±€éƒ¨çŠ¶æ€ï¼Œæ‰€ä»¥å½“å‡½æ•°ç¦»å¼€æ—¶ï¼Œä¹Ÿèƒ½æ¢å¤æ‰§è¡Œã€‚æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š","text":"yieldç”¨æ³•åœ¨pythonä¸­ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°é‡Œé¢å«æœ‰yieldè¯­å¥ï¼Œé‚£ä¹ˆè°ƒç”¨å‡½æ•°ï¼Œè¿”å›çš„ä¸æ˜¯å‡½æ•°çš„returnç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ã€‚ä¹‹åè¿›è¡Œæ“ä½œèƒ½å°†è¿™ä¸ªå‡½æ•°è¿”å›ä¸­é—´ç»“æœç»™è°ƒç”¨è€…ï¼Œç„¶åç»´æŠ¤å‡½æ•°çš„å±€éƒ¨çŠ¶æ€ï¼Œæ‰€ä»¥å½“å‡½æ•°ç¦»å¼€æ—¶ï¼Œä¹Ÿèƒ½æ¢å¤æ‰§è¡Œã€‚æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š 123456def fib(n_max): n,a,b = 0,0,1 while n&lt;n_max: yield b a,b = b,a+b n += 1 è°ƒç”¨å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ 12In [53]: fib(6)Out[53]: &lt;generator object fib at 0x103eb5640&gt; æƒ³è¦å¾—åˆ°ç»“æœï¼Œéœ€è¦å†æ¬¡å°†å…¶å½“åšå¯è¿­ä»£å¯¹è±¡å¤„ç†ï¼Œä¾‹å¦‚ä½¿ç”¨foræˆ–å¤šæ¬¡ä½¿ç”¨nextæ–¹æ³•ã€‚ nextå’Œsendæ–¹æ³•å«yieldè¯­å¥çš„å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ç±»ï¼Œè¿™ä¸ªç”Ÿæˆå™¨è‡ªå¸¦ä¸€ä¸ªnextæ–¹æ³•ï¼Œæ¯æ¬¡è°ƒç”¨x.next()æ—¶ï¼Œä¼šæ‰§è¡Œå‡½æ•°ç±»çš„ä»£ç ï¼Œç›´åˆ°å‡ºç°äº†yieldï¼Œç¨‹åºè¿”å›yieldåé¢çš„ç»“æœã€‚ç¨‹åºå¹¶æŒ‚èµ·ï¼Œç›´åˆ°ä¸‹æ¬¡è°ƒç”¨next()ï¼Œç¨‹åºç»§ç»­æ‰§è¡Œã€‚ç›´åˆ°å‡ºç°yieldç¨‹åºå†æ¬¡æŒ‚èµ·ã€‚æ¥çœ‹ä¸ªä¾‹å­å§ã€‚ 1234567891011121314151617181920212223242526In [55]: def func(): ....: print \"aaaa\" ....: yield 1 ....: print \"bbbb\" ....: yield 2 ....: print \"cccc\" ....: yield 3 ....:In [56]: c = func()In [57]: cOut[57]: &lt;generator object func at 0x103eb5690&gt;In [58]: c.next()aaaaOut[58]: 1In [59]: c.next()bbbbOut[59]: 2In [60]: c.next()ccccOut[60]: 3In [61]: c.next()---------------------------------------------------------------------------StopIteration Traceback (most recent call last)&lt;ipython-input-61-50b4dad19337&gt; in &lt;module&gt;()----&gt; 1 c.next()StopIteration: å¦‚æœæˆ‘ä»¬å°†yieldçœ‹åšè¡¨è¾¾å¼ï¼Œå¹¶èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œé‚£è¿™ä¸ªå˜é‡çš„å¾—åˆ°çš„æ˜¯ä»€ä¹ˆå‘¢ã€‚å°±åƒè¿™æ ·ï¼š 123456def func(): print \"start\" a = yield 1 print \"a:\", a b = yield 2 print \"b:\", b è¿™é‡Œaå¾—åˆ°çš„å¹¶ä¸æ˜¯1ï¼Œbå¹¶ä¸æ˜¯2. 12345678In [69]: c.next()startOut[69]: 1In [70]: c.next()a: NoneOut[70]: 2In [71]: c.next()b: None nextæ–¹æ³•è¿”å›çš„æ‰æ˜¯yieldåé¢çš„å†…å®¹ï¼Œa,bå¾—åˆ°çš„æ˜¯Noneã€‚ç”Ÿæˆå™¨é‡Œé¢è¿˜æœ‰ä¸€ä¸ªå‡½æ•°æ˜¯sendå‡½æ•°ï¼Œè°ƒç”¨sendå‡½æ•°ä¹Ÿæœ‰nextå‡½æ•°çš„æ•ˆæœï¼Œæˆ–è€…å…¶å®è¯´c.next()ç›¸å½“äºè°ƒç”¨c.send(None)ã€‚a,bå¾—åˆ°çš„Noneå°±æ¥è‡ªsendçš„å€¼ã€‚å†çœ‹ï¼š 1234567891011In [79]: c = func()In [80]: r = c.next()startIn [81]: rOut[81]: 1In [82]: r2 = c.send(\"lalala\")a: lalalaIn [83]: r2Out[83]: 2In [84]: r3 = c.send(\"hahaha\")b: hahaha æ³¨æ„ç¬¬ä¸€æ¬¡è°ƒç”¨è°ƒç”¨çš„æ˜¯send(None)æˆ–next().å¯ä»¥çœ‹å‡ºsendæ–¹æ³•è¿”å›çš„æ˜¯yieldåé¢çš„ä¸œè¥¿ï¼Œè€Œyieldèµ‹å€¼ç»™çš„å˜é‡a,bå¾—åˆ°çš„æ˜¯sendå‡½æ•°é‡Œé¢çš„å†…å®¹ã€‚æ­£å¼yieldçš„è¿™ç§ç‰¹æ€§å¯ä»¥ç”¨æ¥å®ç°åç¨‹ï¼Œç¨‹åºåœ¨æŸä¸ªæ—¶åˆ»é€šè¿‡yieldæŒ‚èµ·å½“å‰å‡½æ•°ï¼Œåˆ‡æ¢åˆ°å…¶ä»–åœ°æ–¹è¿è¡Œä»£ç ï¼Œå†åœ¨æŸä¸ªæ—¶åˆ»è°ƒç”¨send()ã€‚ç¨‹åºç»§ç»­æ‰§è¡Œã€‚ä¾‹å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¯”è¾ƒè€—æ—¶çš„ioæ“ä½œ,å¯ä»¥é€šè¿‡yieldåˆ‡æ¢åˆ°å…¶ä»–ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œå½“ioæ“ä½œå¥½äº†çš„æ—¶å€™ï¼Œé€šè¿‡sendé€šçŸ¥å‡½æ•°ç»§ç»­æ‰§è¡Œï¼Œç¨‹åºä¸ä¼šé˜»å¡åœ¨ioæ“ä½œä¸Šã€‚tornadoä¹Ÿæ˜¯å€ŸåŠ©è¿™ç§æ–¹å¼æ¥å®ç°åç¨‹è¿›è¡Œå¼‚æ­¥æ“ä½œã€‚ Futureç±»åˆ†æFutureç±»æ˜¯tornadoä¸€ä¸ªç‰¹åˆ«é‡è¦çš„ç±»ï¼Œtornadoå€ŸåŠ©Futureç±»ä¿å­˜ç¨‹åºå¼‚æ­¥çš„ç»“æœã€‚è¿™ä¸ªç»“æœåŒ…æ‹¬è¿”å›å€¼ï¼Œå¼‚å¸¸ä¿¡æ¯ï¼Œå›è°ƒå‡½æ•°ã€‚ä¾‹å¦‚åˆšæ‰é‡åˆ°è€—æ—¶ioæ“ä½œæ—¶ï¼Œå°†è€—æ—¶æ“ä½œåŒ…æ‹¬å›è°ƒç­‰å°è£…Futureä¸­ï¼Œç„¶åé€šè¿‡yieldè¿”å›ã€‚é€šè¿‡ioloopæ¥å¼‚æ­¥å¤„ç†ï¼Œæœ€åè°ƒç”¨Futureçš„set_resultå°†ioæ“ä½œç»“æœæ”¾å…¥Futureä¸­ã€‚æ¥çœ‹çœ‹ä¸»è¦æºç åŠå®ƒæ‹¥æœ‰çš„å±æ€§å’Œæ–¹æ³•å§ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465class Future(object): def __init__(self): self._done = False self._result = None self._exc_info = None self._callbacks = [] def running(self): \"\"\"Returns True if this operation is currently running.\"\"\" return not self._done def done(self): \"\"\"Returns True if the future has finished running.\"\"\" return self._done def result(self, timeout=None): self._clear_tb_log() if self._result is not None: return self._result if self._exc_info is not None: raise_exc_info(self._exc_info) self._check_done() return self._result def exception(self, timeout=None): \"\"\" è¿”å›å¼‚å¸¸ä¿¡æ¯ \"\"\" self._clear_tb_log() if self._exc_info is not None: return self._exc_info[1] else: self._check_done() return None def add_done_callback(self, fn): if self._done: fn(self) else: self._callbacks.append(fn) def set_result(self, result): \"\"\"Sets the result of a ``Future``. It is undefined to call any of the ``set`` methods more than once on the same object. \"\"\" self._result = result self._set_done() def set_exception(self, exception): \"\"\"Sets the exception of a ``Future.``\"\"\" self.set_exc_info( (exception.__class__, exception, getattr(exception, '__traceback__', None))) def exc_info(self): \"\"\"çœç•¥\"\"\" def set_exc_info(self, exc_info): \"\"\"çœç•¥\"\"\" def _check_done(self): if not self._done: raise Exception(\"DummyFuture does not support blocking for results\") def _set_done(self): self._done = True for cb in self._callbacks: try: cb(self) except Exception: app_log.exception('Exception in callback %r for %r', cb, self) self._callbacks = None running()æ–¹æ³•è·å–Futureæ˜¯å¦å¤„ç†å®Œå¾—åˆ°resultã€‚å¦‚æœå¾—åˆ°è¿”å›Falseï¼Œæ²¡æœ‰è¡¨ç¤ºè¿˜åœ¨è¿è¡Œï¼Œè¿”å›True. done()æ­£å¥½å’Œrunningæ–¹æ³•ç›¸å result()è·å–Futureå¤„ç†å®Œçš„ç»“æœï¼Œå¦‚æœæ²¡æœ‰å¤„ç†å®Œï¼Œåˆ™ä¼šè·‘å‡ºä¸€ä¸ªDummyFuture does not support blocking for resultsçš„å¼‚å¸¸ add_done_callback(fn) å°†å›è°ƒå‡½æ•°æ·»åŠ åˆ°Futureå¯¹è±¡ä¸­,å¦‚æœFutureå·²ç»å¤„ç†å®Œï¼Œåˆ™ç›´æ¥æ‰§è¡Œfnï¼Œå¦åˆ™å°†fnæ·»åŠ åˆ°å›è°ƒå‡½æ•°åˆ—è¡¨ä¸­ï¼Œä¹‹ååœ¨æ‰§è¡Œ set_resultå°†ç»“æœèµ‹å€¼ç»™Futureå¯¹è±¡ï¼Œå¹¶è°ƒç”¨_set_done()æ‰§è¡Œå›è°ƒå‡½æ•° _check_doneæ£€æŸ¥Futureæ˜¯å¦æ‰§è¡Œå®Œå¾—åˆ°ç»“æœï¼Œæ²¡æœ‰åˆ™è·‘å‡ºå¼‚å¸¸ _set_doneè®¾ç½®Futureä¸ºå¤„ç†å®Œï¼Œå¹¶æ‰§è¡Œå›è°ƒå‡½æ•°åˆ—è¡¨ä¸­çš„å‡½æ•°ã€‚ Futureæ˜¯æ²Ÿé€šgenæ¨¡å—å’Œioloopæ¨¡å—çš„ä¸€åº§æ¡¥æ¢ã€‚å°†yieldè¯­å¥è¿”å›çš„å¯¹è±¡å°è£…åäº¤ç»™ioloopå»è°ƒåº¦å¤„ç†ã€‚ epollç†è§£epollæ˜¯å¯¹selectå’Œpollçš„æ”¹è¿›ç‰ˆæœ¬ã€‚ç›¸å¯¹äºå¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹æŠ€æœ¯æ¥è¯´ï¼Œè¿™ç§I/Oå¤šè·¯å¤ç”¨æŠ€æœ¯æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯å‡å°‘äº†ç³»ç»Ÿå¼€é”€ï¼Œé€šè¿‡ç›‘å¬ç­‰å¾…æ–‡ä»¶æ“ä½œç¬¦æ˜¯å¦å°±ç»ªï¼Œå¦‚æœå°±ç»ªï¼Œè¿›ç¨‹å°†æ‰€è¯»æ•°æ®å¤åˆ¶åˆ°åº”ç”¨è¿›ç¨‹ç¼“å­˜åŒºè¿›è¡Œå¤„ç†ï¼Œä¸éœ€è¦åˆ›å»ºè¿›ç¨‹å’Œçº¿ç¨‹ï¼Œä¹Ÿä¸å¿…ç»´æŠ¤è¿™äº›è¿›ç¨‹çº¿ç¨‹ã€‚ç­‰å¾…å°±ç»ªï¼Œåˆæ­¥çœ‹æœ‰äº›åƒå¤šçº¿ç¨‹ä¸­çš„é˜»å¡io,ä½†selectç­‰å‡½æ•°å¯ä»¥åŒæ—¶ç›‘å¬ç­‰å¾…å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œæ€§èƒ½å°±å¤§å¤§æå‡å•¦ã€‚ç›¸å¯¹äºselectå’Œpollã€‚epollçš„ä¼˜ç‚¹æ˜¯æ²¡æœ‰ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦çš„é™åˆ¶ã€‚ä¸”selectå’Œpolléœ€è¦ä¸æ–­è½®è¯¢æ‰€æœ‰fd(æ–‡ä»¶æè¿°ç¬¦ï¼‰é›†åˆï¼Œç›´åˆ°è®¾å¤‡å°±ç»ªã€‚epollåˆ™æ˜¯è®¾å¤‡å°±ç»ªæ—¶ï¼Œè°ƒç”¨å›è°ƒå‡½æ•°ï¼Œå°†å°±ç»ªfdæ”¾å…¥å°±ç»ªè¡¨ä¸­ï¼Œä¹‹ååªè¦åˆ¤æ–­å°±ç»ªè¡¨æ˜¯ä¸æ˜¯ä¸ºç©ºå°±è¡Œå•¦ã€‚åœ¨Linuxä¸‹ç³»ç»Ÿå®ç°äº†epollæ¨¡å‹ï¼Œå…¶ä»–å¹³å°ç±»ä¼¼çš„æ˜¯kqueueã€‚ Pythonä¸­epollå°è£…åœ¨selectæ¨¡å—ä¸­ã€‚æ¥çœ‹ä¸ªç®€å•çš„ä½¿ç”¨ä¾‹å­ï¼Œ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import socketimport selectclass EpollServer(object): def __init__(self, host='localhost', port=8888): self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) #è®¾ç½®åœ°å€å¯é‡ç”¨ self.sock.bind((host, port)) self.sock.listen(1) self.sock.setblocking(0) #è®¾ç½®éé˜»å¡ self.epoll = select.epoll() self.epoll.register(self.sock.fileno(), select.EPOLLIN) def run(self): try: conns = &#123;&#125; reqs = &#123;&#125; resps = &#123;&#125; while True: events = self.epoll.poll(1) for fileno, event in events: if fileno == self.sock.fileno(): conn,addr = self.sock.accept() conn_fileno = conn.fileno() conn.setblocking(0) self.epoll.register(conn.fileno, select.EPOLLIN) conns[conn_fileno] = conn reqs[conn_fileno] = b'' resps[conn_fileno] = b\"\"\"HTTP/1.0 200 OK\\r\\nDate: Mon, 1 Jan 1996 01:01:01 GMT\\r\\n Content-Type: text/plain\\r\\nContent-Length: 13\\r\\n\\r\\nHello, world!\"\"\" elif event &amp; select.EPOLLIN: reqs[fileno]+=conns[fileno].recv(1024) if b'\\n\\n' in reqs[fileno] or b'\\n\\r\\n' in reqs[fileno]: self.epoll.modify(fileno, select.EPOLLOUT) print(reqs[fileno].decode()) elif event &amp; select.EPOLLOUT: len_write = conns[fileno].send(resps[fileno]) resps[fileno] = resps[fileno][len_write:] if len(resps[fileno]) == 0: self.epoll.modify(fileno, 0) conns[fileno].shutdown(socket.SHUT_RDWR) elif event &amp; select.EPOLLHUB: self.epoll.unregister(fileno) conns[fileno].close() del conns[fileno] finally: self.epoll.unregister(self.sock.fileno()) self.epoll.close() self.sock.close()if __name__ == '__main__': epoll_server = EpollServer() epoll_server.run() ç¨‹åºæ‘˜è‡ªã€ŠPythonç½‘ç»œç¼–ç¨‹æ”»ç•¥ã€‹ã€‚è°ƒç”¨select.epoll()å®ä¾‹åŒ–åï¼Œé€šè¿‡registerå‡½æ•°æ¥ç™»è®°ä¸€ä¸ªç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦å’Œäº‹ä»¶ã€‚è¿›å…¥whileå¾ªç¯ï¼Œpoll()æ–¹æ³•è¿”å›ç›‘å¬åˆ°çš„äº‹ä»¶eventå’Œæ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨ã€‚ å¦‚æœæ˜¯æœåŠ¡å™¨socketäº‹ä»¶ï¼Œå»ºç«‹è¿æ¥ï¼Œè®¾ç½®éé˜»å¡ï¼Œæ·»åŠ ç›‘å¬è¯»äº‹ä»¶ã€‚ å¦‚æœäº‹ä»¶eventæ˜¯å¯è¯»ï¼Œåˆ™è¯»å–æ•°æ®ï¼ŒæŸä¸ªè¯·æ±‚è¯»å®Œåï¼Œæ›´æ–°(è°ƒç”¨modify)ç›‘å¬äº‹ä»¶ä¸ºç›‘å¬æ˜¯å¦å¯å†™ã€‚ å¦‚æœäº‹ä»¶eventæ˜¯å¯å†™ï¼Œå‘é€éœ€è¦å“åº”å›çš„æ•°æ®ï¼Œå‘é€å®Œå,æ›´æ”¹ç›‘å¬äº‹ä»¶ï¼Œ å¦‚æœæ–‡ä»¶æè¿°ç¬¦è¢«æŒ‚æ–­ï¼Œ è°ƒç”¨unregisterä¸å†ç›‘å¬æ­¤æ–‡ä»¶æè¿°ç¬¦ï¼Œå…³é—­socketè¿æ¥ï¼Œå¹¶åˆ é™¤ã€‚ ä¸»è¦çš„å‡ ä¸ªæ–¹æ³•å°±æ˜¯poll,register,modify,unregister,closeã€‚ tornadoåœ¨linuxä¸‹æ˜¯é€šè¿‡epollæ¥å®ç°I/Oå¤šè·¯å¤ç”¨ã€‚å¯¹ioäº‹ä»¶è¿›è¡Œç›‘å¬ï¼Œioloop ioloopæ¨¡å—åˆ†æioloopæ˜¯tornadoåº•å±‚çš„æ ¸å¿ƒï¼Œä¸»è¦è°ƒåº¦å¤„ç†ioè¯»å†™é”™è¯¯äº‹ä»¶ä»¥åŠå›è°ƒå’Œè¶…æ—¶ç­‰ä»»åŠ¡ã€‚å½“ç¨‹åºç¢°åˆ°yieldåˆ‡æ¢æ—¶ï¼Œä¾¿å°†yieldåé¢çš„Futureäº¤ç»™iooopè°ƒåº¦å¤„ç†ï¼Œç¨‹åºåˆ‡æ¢æ‰§è¡Œå…¶ä»–ä»£ç ã€‚ Configurableç±» ioloopæ¨¡å—ä¸­ï¼Œé‡è¦çš„æ˜¯IOLoopç±»ï¼Œå®ƒç»§æ‰¿è‡ªConfigurableç±»ï¼ŒConfigurableæ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒè´Ÿè´£è®©IOLoopå®ä¾‹åŒ–å¯¹è±¡æ—¶ï¼Œä¼šæ ¹æ®ä¸åŒçš„å¹³å°ï¼Œå®ä¾‹æˆä¸åŒçš„å¯¹è±¡ï¼Œä¾‹å¦‚Linuxå®ä¾‹åŒ–ä¹‹åå°±å¯ä»¥è°ƒç”¨EPollIOLoopç±»çš„æ‰€æœ‰æ–¹æ³•ã€‚æ­£å¦‚æˆ‘ä»¬ä¸€èˆ¬é€šè¿‡tornado.ioloop.IOLoop.instance().start()æ¥å¯åŠ¨IOLoop,ä½†å…¶å®åœ¨Linuxä¸‹ï¼Œå¯åŠ¨çš„æ˜¯EpollIOLoopå®ä¾‹ï¼Œæ‰§è¡Œçš„ä¹Ÿæ˜¯é‡Œé¢çš„æ–¹æ³•ã€‚çœ‹çœ‹æºç å¯èƒ½æ¸…æ™°è®¸å¤š 12345678910111213141516def __new__(cls, *args, **kwargs): base = cls.configurable_base() init_kwargs = &#123;&#125; if cls is base: impl = cls.configured_class() if base.__impl_kwargs: init_kwargs.update(base.__impl_kwargs) else: impl = cls init_kwargs.update(kwargs) instance = super(Configurable, cls).__new__(impl) # initialize vs __init__ chosen for compatibility with AsyncHTTPClient # singleton magic. If we get rid of that we can switch to __init__ # here too. instance.initialize(*args, **init_kwargs) return instance åœ¨Linuxå¹³å°ä¸‹ï¼Œconfigurable_base()è¿”å›ä¸€ä¸ªIOLoopç±»,configured_class()è¿”å›çš„æ˜¯EPollIOLoopç±»ã€‚ç»§æ‰¿äº†Configurableç±»çš„ç±»å®ä¾‹åŒ–æ—¶ï¼Œè¿”å›çš„å®ä¾‹åœ¨Linuxä¸‹å…¶å®æ˜¯ä¸€ä¸ªEPollIOLoopå®ä¾‹ï¼ŒåŒç†ï¼Œå¦‚æœç³»ç»Ÿä½¿ç”¨çš„æ˜¯kqueueï¼Œå®ä¾‹åˆ™æ˜¯ä¸€ä¸ªKQueueIOLoopå®ä¾‹ IOLoopç±» IOloopæ¯”è¾ƒå¤æ‚ï¼Œä¸»è¦è´Ÿè´£è°ƒåº¦ã€‚é€šè¿‡æºç æ¥çœ‹çœ‹ä¸€äº›å¸¸è§çš„æ–¹æ³•ã€‚æˆ‘ä»¬é€šå¸¸è°ƒç”¨tornado.ioloop.IOLoop.current().start()æ¥å¯åŠ¨å®ä¾‹ï¼Œcurrent()ä¼šåˆ¤æ–­å½“å‰æœ‰æ²¡æœ‰å®ä¾‹instanceï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è°ƒç”¨instance()æ–¹æ³•åˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚instance()é‡‡ç”¨äº†å•ä¾‹æ¨¡å¼ï¼Œå³ä½¿å¤šæ¬¡è°ƒç”¨ï¼Œåˆ›å»ºçš„ä¹Ÿæ˜¯åŒä¸€ä¸ªå…¨å±€IOLoopå®ä¾‹ã€‚ 12345678910@staticmethoddef instance(): \"\"\"Returns a global `IOLoop` instance. \"\"\" if not hasattr(IOLoop, \"_instance\"): with IOLoop._instance_lock: if not hasattr(IOLoop, \"_instance\"): # New instance after double check IOLoop._instance = IOLoop() return IOLoop._instance å®ä¾‹åˆ›å»ºåï¼Œéœ€è¦é€šè¿‡start()æ–¹æ³•æ¥å¯åŠ¨ã€‚è¿™ä¸ªæ–¹æ³•å®ç°åœ¨å­ç±»PollIOLoopç±»ä¸­ã€‚ä¹Ÿæ˜¯è¿™ä¸ªæ¨¡å—ä¸­æœ€å¤æ‚çš„ä¸€ä¸ªå‡½æ•°ã€‚æ¥çœ‹ä¸»è¦ä»£ç : 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182while True: #è·å–é”ï¼Œç„¶åå°†å›è°ƒå‡½æ•°åˆ—è¡¨æ¸…ç©º with self._callback_lock: callbacks = self._callbacks self._callbacks = [] due_timeouts = [] #å¦‚æœæœ‰è¶…æ—¶ä»»åŠ¡,ä¸”å·²ç»è¶…æ—¶ï¼Œå¤„ç†è¶…æ—¶ä»»åŠ¡ã€‚è¿˜æœªè¶…æ—¶ï¼Œæ·»åŠ åˆ°due_timeoutsåˆ—è¡¨ä¸­. if self._timeouts: now = self.time() while self._timeouts: if self._timeouts[0].callback is None: # The timeout was cancelled. Note that the # cancellation check is repeated below for timeouts # that are cancelled by another timeout or callback. heapq.heappop(self._timeouts) self._cancellations -= 1 elif self._timeouts[0].deadline &lt;= now: due_timeouts.append(heapq.heappop(self._timeouts)) else: break if (self._cancellations &gt; 512 and self._cancellations &gt; (len(self._timeouts) &gt;&gt; 1)): # Clean up the timeout queue when it gets large and it's # more than half cancellations. self._cancellations = 0 self._timeouts = [x for x in self._timeouts if x.callback is not None] heapq.heapify(self._timeouts) #å¤„ç†å›è°ƒå‡½æ•° for callback in callbacks: self._run_callback(callback) #å¤„ç†å¿«è¦è¶…æ—¶çš„è¶…æ—¶ä»»åŠ¡ for timeout in due_timeouts: if timeout.callback is not None: self._run_callback(timeout.callback) # Closures may be holding on to a lot of memory, so allow # them to be freed before we go into our poll wait. callbacks = callback = due_timeouts = timeout = None #å¦‚æœåˆšæ¸…ç©ºçš„_callbacksåˆæœ‰å›è°ƒä»»åŠ¡æˆ–è¶…æ—¶å›è°ƒä»»åŠ¡æ·»åŠ è¿›æ¥ï¼Œè°ƒç”¨ä»–ä»¬ä¹‹å‰ä¸åœ¨poll(poll_timeout)ä¸­ç­‰å¾…ä¸‹ä¸€æ¬¡è½®è¯¢ if self._callbacks: poll_timeout = 0.0 elif self._timeouts: # If there are any timeouts, schedule the first one. # Use self.time() instead of 'now' to account for time # spent running callbacks. poll_timeout = self._timeouts[0].deadline - self.time() poll_timeout = max(0, min(poll_timeout, _POLL_TIMEOUT)) else: # No timeouts and no callbacks, so use the default. poll_timeout = _POLL_TIMEOUT if not self._running: break if self._blocking_signal_threshold is not None: # clear alarm so it doesn't fire while poll is waiting for # events. signal.setitimer(signal.ITIMER_REAL, 0, 0) try: #å¼€å§‹ç›‘å¬äº‹ä»¶ event_pairs = self._impl.poll(poll_timeout) except Exception as e: if errno_from_exception(e) == errno.EINTR: continue else: raise self._events.update(event_pairs) å¦‚æœç›‘å¬åˆ°äº‹ä»¶ï¼Œå¤„ç†äº‹ä»¶ while self._events: fd, events = self._events.popitem() try: fd_obj, handler_func = self._handlers[fd] handler_func(fd_obj, events) except (OSError, IOError) as e: if errno_from_exception(e) == errno.EPIPE: # Happens when the client closes the connection pass else: self.handle_callback_exception(self._handlers.get(fd)) except Exception: self.handle_callback_exception(self._handlers.get(fd)) fd_obj = handler_func = None ä¸»è¦åšçš„å°±æ˜¯ç›‘å¬äº‹ä»¶ï¼Œå¤„ç†äº‹ä»¶ï¼Œä»¥åŠå¤„ç†å›è°ƒå‡½æ•°ä»¥åŠè¶…æ—¶å›è°ƒå‡½æ•°ï¼Œæ³¨æ„è¿™é‡Œçš„è¶…æ—¶å›è°ƒå‡½æ•°è¡¨æ˜¯ä¸€ä¸ªæœ€å°å †ï¼Œæ ¹æ®éœ€è¦åœ¨æŸä¸ªæ—¶åˆ»æ‰§è¡Œæ ¹æ®æ—¶é—´å¯¹æˆäº†å †ï¼Œæ¯æ¬¡ä»å †ä¸­æ‹¿å‡ºæ¥çš„ç¬¬ä¸€ä¸ªä»»åŠ¡å°±æ˜¯ç¦»ç°åœ¨æœ€è¿‘çš„ä»»åŠ¡ï¼Œä»è€Œå®ç°å»¶æ—¶å¤„ç†çš„æ•ˆæœã€‚ æ¥ä¸‹æ¥æ¥çœ‹å‡ ä¸ªé‡è¦çš„å‡½æ•°: add_handler(fd,handler,events)å‡½æ•° 1234def add_handler(self, fd, handler, events): fd, obj = self.split_fd(fd) self._handlers[fd] = (obj, stack_context.wrap(handler)) self._impl.register(fd, events | self.ERROR) fdä¸ºä¸€ä¸ªæ–‡ä»¶æ“ä½œç¬¦ï¼Œhandlerä¸ºä¸€ä¸ªå¤„ç†å‡½æ•°ï¼Œeventsä¸ºioäº‹ä»¶ï¼Œè¿™ä¸ªå‡½æ•°ä½¿ç”¨epollç™»è®°ç›‘å¬fdä¸Šçš„eventsï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè°ƒç”¨handler(fd,eventså¤„ç†äº‹ä»¶) add_timeout(deadline,callback,args,*kwargs)å‡½æ•°ã€‚åœ¨deadlineçš„æ—¶å€™è°ƒç”¨callbackå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°è°ƒç”¨çš„æ˜¯å®ç°åœ¨PollIOLoopç±»ä¸­çš„call_atå‡½æ•°ï¼Œcall_atå‡½æ•°ä¼šå°†ä»»åŠ¡å°è£…åæ·»åŠ åˆ°start()ä¸­çœ‹åˆ°è¿‡çš„self._timeoutså †ä¸­ã€‚ add_callback(callback,args,*kwargs)å‡½æ•°,ä¹Ÿæ˜¯åœ¨PollIOLoopä¸­å®ç° 123456789101112131415def add_callback(self, callback, *args, **kwargs): if thread.get_ident() != self._thread_ident: with self._callback_lock: if self._closing: return list_empty = not self._callbacks self._callbacks.append(functools.partial( stack_context.wrap(callback), *args, **kwargs)) if list_empty: self._waker.wake() else: if self._closing: return self._callbacks.append(functools.partial( stack_context.wrap(callback), *args, **kwargs) ä¹Ÿæ˜¯åœ¨PollIOLoopä¸­å®ç°ï¼Œå°†ä»»åŠ¡é€šè¿‡åå‡½æ•°åŒ…è£…åï¼Œæ·»åŠ åˆ°å›è°ƒå‡½æ•°åˆ—è¡¨ä¸­ã€‚åœ¨ä¹‹åçš„å¾ªç¯ä¸­å¤„ç†ã€‚ add_future(future,callback)å‡½æ•° 12345678910def add_future(self, future, callback): \"\"\"Schedules a callback on the ``IOLoop`` when the given `.Future` is finished. The callback is invoked with one argument, the `.Future`. \"\"\" assert is_future(future) callback = stack_context.wrap(callback) future.add_done_callback( lambda future: self.add_callback(callback, future)) æ·»åŠ ä¸€ä¸ªcallbackå‡½æ•°åˆ°Futureå¯¹è±¡ä¸­ï¼Œå½“Futureå¯¹è±¡è¢«set_result,æ‰§è¡Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå³è¿™ä¸ªlambdaå‡½æ•°ï¼Œåœ¨lambdaå‡½æ•°ä¸­è°ƒç”¨IOLoopçš„add_callbackå‡½æ•°ã€‚å°†add_futureçš„å‚æ•°callbackåŠ å…¥åˆ°IOLoopçš„ç»Ÿä¸€è°ƒåº¦ä¸­ï¼Œè®©callbackåœ¨IOLoopä¸‹ä¸€æ¬¡è¿­ä»£ä¸­æ‰§è¡Œã€‚ run_sync(func,timeout=None)å‡½æ•° iostreamæ¨¡å—åˆ†æiostreamæ¨¡å—ä¸­IOStreamä¸»è¦æ˜¯å¯¹socketè¯»å†™è¿›è¡Œå°è£…ã€‚ç±»åˆå§‹åŒ–æ—¶ï¼Œä¼šç»‘å®šä¸€ä¸ªsocketï¼Œç»‘å®šä¸€ä¸ªioloopã€‚ç„¶ååˆ†åˆ«åˆ›å»ºä¸€ä¸ªè¯»ç¼“å†²åŒº_read_bufferå’Œä¸€ä¸ªå†™ç¼“å†²åŒº_write_bufferã€‚è¿™ä¸¤ä¸ªç¼“å­˜åŒºéƒ½æ˜¯collections.deque()åŒç«¯é˜Ÿåˆ—ç±»å‹ã€‚ è¯»å†™æ¥å£ read_until(delimiter,callback=None,max_bytes=None)å¼‚æ­¥ä»ç¼“å†²åŒºè¯»å–æ•°æ®ç›´åˆ°è¯»å–åˆ°äº†åˆ†éš”ç¬¦delimiterã€‚å¦‚æœæœ‰callbackå‡½æ•°ï¼Œè¯»å–åˆ°æ•°æ®åæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå¦‚æœç¼“å†²åŒºæ²¡æœ‰æ•°æ®ï¼Œåˆ™éœ€è¦å…ˆè°ƒç”¨_read_to_buffer()ä»socketè¯»å–æ•°æ®ï¼Œç„¶åå°†æ•°æ®å†™å…¥bufferä¸­ã€‚å¦‚æœmax_bytesç»™äº†ï¼Œå¦‚æœæ²¡æœ‰ç¢°åˆ°delimiterï¼Œåˆ™ä¼šä¸€ç›´è¯»å–æ•°æ®ï¼Œè¶…è¿‡max_bytesåä¼šå…³é—­è¿æ¥ã€‚ read_until_regex(regex,callback=None,max_bytes=None)å’Œread_untilç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å°†delimiteræ¢æˆäº†ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä»ç¼“å†²åŒºè¯»å–æ•°æ®ç›´åˆ°è¯»å–åˆ°çš„æ•°æ®æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼ read_bytes(num_bytes, callback=None, streaming_callback=None,partial=False)å¼‚æ­¥è¯»å–é•¿åº¦ä¸ºnum_bytesçš„æ•°æ®ã€‚ read_until_close(callback=None, streaming_callback=None) å¼‚æ­¥è¯»å–æ•°æ®ç›´åˆ°socketå…³é—­ write(data,callback=None) å°†æ•°æ®å†™å…¥ç¼“å­˜åŒºä¸­ã€‚ å‡ ä¸ªä¸»è¦çš„å†…éƒ¨å‡½æ•°ï¼š write_to_fd(data) å°†æ•°æ®å†™å…¥socketä¸­ï¼Œå‘é€å‡ºå» read_from_fd ä»socketè¯»å–æ•°æ® _read_to_buffer è¯»å–socketçš„æ•°æ®å¹¶æ·»åŠ åˆ°ç¼“å†²åŒºbufferä¸­ã€‚ _read_from_bufferä»bufferä¸­è¯»å–æ•°æ® _try_inline_read()è¯•ç€ä»bufferè¯»å–æ•°æ®ï¼Œå¦‚æœæ•°æ®æ²¡æœ‰æˆ–ä¸å¤Ÿï¼Œåˆ™å¼€å§‹ç›‘å¬socketï¼Œè¯»å–æ–°çš„æ•°æ® _add_io_state(state) åœ¨ioloopä¸­æ³¨å†Œäº‹ä»¶çŠ¶æ€ï¼Œè°ƒç”¨çš„æ˜¯ioloopçš„add_handlerå‡½æ•°ï¼Œç›‘å¬socketï¼Œå½“æ»¡è¶³stateçŠ¶æ€æ—¶ï¼Œè°ƒç”¨self._handle_eventså¤„ç†äº‹ä»¶ã€‚ è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€é¢çš„å‡½æ•°æ˜¯_consume(loc)ï¼Œä»–èƒ½å°†ç¼“å†²åŒºçš„å‰locä¸ªæ•°æ®åˆå¹¶ï¼Œä¾‹å¦‚[â€˜abcâ€™,â€™deâ€™,â€™fghâ€™,â€™iâ€™]åˆå¹¶å‰6ä¸ªæ•°æ®åå˜æˆäº†[â€˜abcdefâ€™,â€™ghâ€™,â€™iâ€™]ç„¶åè°ƒç”¨popleft()è¿”å›è¿™locå­—èŠ‚æ•°æ® gen.coroutineè£…é¥°å™¨åˆ†æcoroutineè£…é¥°å™¨ä¸»è¦ä½œç”¨æ˜¯å°†ï¼Œæœ¬æ¥éœ€è¦å¼‚æ­¥å›è°ƒå†™çš„ä»£ç ï¼Œçœ‹èµ·æ¥åƒæ˜¯åœ¨å†™åŒæ­¥å‡½æ•°ã€‚ä¾‹å¦‚æŠ“å–ä¸€ä¸ªç½‘é¡µï¼Œå›è°ƒå†™æ³•æ˜¯: 12345678910111213from tornado.httpclient import AsyncHTTPClientimport tornado.ioloopdef callback(response): do_something(response)def asychronous_fetch(url, callback): httpclient = AsyncHTTPClient() def handle_response(response): callback(response.body) httpclient.fetch(url,callback=handle_response)if __name__ == '__main__': url = 'http://www.baidu.com' asychronous_fetch(url, callback) tornado.ioloop.IOLoop.instance().start() é€šè¿‡coroutineè£…é¥°å™¨ï¼Œä»£ç å†™èµ·æ¥æ˜¯è¿™æ ·çš„ 123456789101112from tornado import genfrom tornado.httpclient import AsyncHTTPClientimport tornadourl = 'http://www.baidu.com'@gen.coroutinedef fetch_cor(url): http_client = AsyncHTTPClient() response = yield http_client.fetch(url) do_something(response.body)if __name__ == '__main__': fetch_cor(url) tornado.ioloop.IOLoop.instance().start() ç›´æ¥è°ƒç”¨å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œè£…é¥°å™¨è°ƒç”¨next()ï¼Œé‡åˆ°yieldæŒ‚èµ·ï¼Œè£…é¥°å™¨å°†yieldåé¢çš„å¯¹è±¡è¿›è¡Œå¼‚æ­¥å¤„ç†ï¼Œå¤„ç†å®Œä¹‹åå°†ç»“æœé€šè¿‡sendå‘é€å›æ¥ï¼Œä¹Ÿå°±è¢«responseæ¥æ”¶ã€‚çœ‹èµ·æ¥åƒæ˜¯åŒæ­¥çš„ä»£ç è¿›è¡Œçš„æ˜¯å¼‚æ­¥å¤„ç†ã€‚ è£…é¥°å™¨ä¸»è¦æºç : 123456789101112131415161718192021222324252627282930313233343536373839def _make_coroutine_wrapper(func, replace_callback): if hasattr(types, 'coroutine'): func = types.coroutine(func) @functools.wraps(func) def wrapper(*args, **kwargs): future = TracebackFuture() if replace_callback and 'callback' in kwargs: callback = kwargs.pop('callback') IOLoop.current().add_future( future, lambda future: callback(future.result())) try: result = func(*args, **kwargs) except: '''çœç•¥''' else: if isinstance(result, GeneratorType): try: orig_stack_contexts = stack_context._state.contexts #åˆæ¬¡è°ƒç”¨next,è·å–yieldè¿”å›çš„å¯¹è±¡ yielded = next(result) if stack_context._state.contexts is not orig_stack_contexts: yielded = TracebackFuture() yielded.set_exception( stack_context.StackContextInconsistentError( 'stack_context inconsistency (probably caused ' 'by yield within a \"with StackContext\" block)')) except (StopIteration, Return) as e: future.set_result(_value_from_stopiteration(e)) except Exception: future.set_exc_info(sys.exc_info()) else: Runner(result, future, yielded) try: return future finally: future = None future.set_result(result) return future return wrapper resultä¸ºç›´æ¥è°ƒç”¨å‡½æ•°è¿”å›çš„è£…é¥°å™¨ï¼Œä¹‹åè°ƒç”¨next()å¾—åˆ°çš„yieldedä¸ºyieldè¯­å¥è¿”å›çš„å¯¹è±¡ã€‚ä¹‹åæ”¾å…¥Runnerç±»åˆå§‹åŒ–è¿‡ç¨‹ä¸­ç»Ÿä¸€å¤„ç†ï¼Œå¤„ç†å®Œåçš„send()ä¹Ÿåœ¨Runnerç±»ä¸­æ‰§è¡Œã€‚ Runnerç±»Runnerå®ä¾‹åŒ–æ—¶ï¼Œä¼šè°ƒç”¨ä¸¤ä¸ªé‡è¦çš„å‡½æ•°ã€‚handle_yield(yielded)å’Œrun()å‡½æ•°ã€‚handle_yieldå‡½æ•°å°†ç¬¬ä¸€æ¬¡è°ƒç”¨next()è¿”å›çš„yieldedè¿›è¡Œå¤„ç†ã€‚handle_yieldçš„éƒ¨åˆ†ä»£ç  1234567891011try: #è½¬åŒ–ä¸ºFuture self.future = convert_yielded(yielded)except BadYieldError: self.future = TracebackFuture() self.future.set_exc_info(sys.exc_info())if not self.future.done() or self.future is moment: self.io_loop.add_future( self.future, lambda f: self.run()) return Falsereturn True å°†yieldedå¯¹è±¡è½¬åŒ–ä¸ºFutureå¯¹è±¡ï¼Œç„¶åè°ƒç”¨add_furure()å°†å›è°ƒå‡½æ•°(è¿™é‡Œä¸ºlambda)å’Œfutureå¯¹è±¡åŠ å…¥ioloopè°ƒåº¦ï¼Œå¦‚æœfutureè¿˜æ²¡æ‰§è¡Œå®Œå¾—åˆ°ç»“æœï¼Œåˆ™éœ€è¦ç­‰set_result()è®¾ç½®resultåï¼Œæ‰ä¼šæ‰§è¡Œè¿™ä¸ªå›è°ƒå‡½æ•°(runå‡½æ•°)ã€‚å¦‚æœæ‰§è¡Œå®Œå¾—åˆ°ç»“æœhandle_yield()è¿”å›True,å¦åˆ™è¿”å›Falseã€‚å¦‚æœè¿”å›Trueï¼Œåˆ™è°ƒç”¨run()å‡½æ•°ã€‚æ¥çœ‹çœ‹runå‡½æ•° 1234567891011121314151617181920212223242526272829303132333435363738def run(self): \"\"\"Starts or resumes the generator, running until it reaches a yield point that is not ready. \"\"\" if self.running or self.finished: return try: self.running = True while True: future = self.future if not future.done(): return self.future = None try: orig_stack_contexts = stack_context._state.contexts exc_info = None try: value = future.result() except Exception: self.had_exception = True exc_info = sys.exc_info() if exc_info is not None: yielded = self.gen.throw(*exc_info) exc_info = None else: #å°†ç»“æœå‘é€å› yielded = self.gen.send(value) if stack_context._state.contexts is not orig_stack_contexts: self.gen.throw( stack_context.StackContextInconsistentError( 'stack_context inconsistency (probably caused ' 'by yield within a \"with StackContext\" block)')) except: \"\"\"çœç•¥\"\"\" if not self.handle_yield(yielded): return finally: self.running = False åˆšæ‰è¯´åªæœ‰Futureå¯¹è±¡å¤„ç†å®Œï¼Œæ‹¿åˆ°result,æ‰è°ƒç”¨run().run()ä¸­å°†resultå‘é€å›å»ï¼Œæ¯”å¦‚ä¸Šé¢ä¾‹å­ä¸­çš„responseå˜é‡ã€‚ httpserveræ¨¡å—åˆ†ætornadoå¤šè¿›ç¨‹","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]},{"title":"å›¾çš„æ·±åº¦ä¼˜å…ˆå’Œå¹¿åº¦ä¼˜å…ˆéå†-Pythonå®ç°","slug":"å›¾çš„æ·±åº¦ä¼˜å…ˆå’Œå¹¿åº¦ä¼˜å…ˆéå†-Pythonå®ç°","date":"2017-01-16T15:04:55.000Z","updated":"2018-03-16T15:08:03.000Z","comments":true,"path":"2017/01/16/å›¾çš„æ·±åº¦ä¼˜å…ˆå’Œå¹¿åº¦ä¼˜å…ˆéå†-Pythonå®ç°/","link":"","permalink":"http://yoursite.com/2017/01/16/å›¾çš„æ·±åº¦ä¼˜å…ˆå’Œå¹¿åº¦ä¼˜å…ˆéå†-Pythonå®ç°/","excerpt":"å›¾åœ¨Pythonä¸­å¯ä»¥è¡¨ç¤ºä¸ºé‚»æ¥çŸ©é˜µ,ä¹Ÿå¯ç§»ç”¨å­—å…¸çš„å½¢å¼æ¥è¡¨ç¤º,å°±åƒè¿™æ ·: 1234567graph = &#123;'A': ['B','C'], 'B': ['D','E'], 'C': ['F','G'], 'D': [], 'E': [], 'F':[], 'G':[]&#125; è¡¨ç¤ºçš„å›¾ä¸º&#39;A&#39;-&gt;&#39;B&#39;,&#39;A&#39;-&gt;&#39;C&#39;,&#39;B&#39;-&gt;&#39;D&#39;,&#39;B&#39;-&gt;&#39;E&#39;,&#39;C&#39;-&gt;&#39;F&#39;,&#39;C&#39;-&gt;&#39;G&#39;","text":"å›¾åœ¨Pythonä¸­å¯ä»¥è¡¨ç¤ºä¸ºé‚»æ¥çŸ©é˜µ,ä¹Ÿå¯ç§»ç”¨å­—å…¸çš„å½¢å¼æ¥è¡¨ç¤º,å°±åƒè¿™æ ·: 1234567graph = &#123;'A': ['B','C'], 'B': ['D','E'], 'C': ['F','G'], 'D': [], 'E': [], 'F':[], 'G':[]&#125; è¡¨ç¤ºçš„å›¾ä¸º&#39;A&#39;-&gt;&#39;B&#39;,&#39;A&#39;-&gt;&#39;C&#39;,&#39;B&#39;-&gt;&#39;D&#39;,&#39;B&#39;-&gt;&#39;E&#39;,&#39;C&#39;-&gt;&#39;F&#39;,&#39;C&#39;-&gt;&#39;G&#39; æ¥ä¸‹æ¥æ¥çœ‹çœ‹å›¾çš„æ·±åº¦ä¼˜å…ˆå’Œå¹¿åº¦ä¼˜å…ˆéå† æ·±åº¦ä¼˜å…ˆè¿‡ç¨‹: 1 è®¿é—®åˆå§‹ç»“ç‚¹vï¼Œå¹¶æ ‡è®°ç»“ç‚¹vä¸ºå·²è®¿é—®ã€‚2 æŸ¥æ‰¾ç»“ç‚¹vçš„ç¬¬ä¸€ä¸ªé‚»æ¥ç»“ç‚¹wã€‚3 è‹¥wå­˜åœ¨ï¼Œåˆ™ç»§ç»­æ‰§è¡Œ4ï¼Œå¦åˆ™ç®—æ³•ç»“æŸã€‚4 è‹¥wæœªè¢«è®¿é—®ï¼Œå¯¹wè¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†é€’å½’ï¼ˆå³æŠŠwå½“åšå¦ä¸€ä¸ªvï¼Œç„¶åè¿›è¡Œæ­¥éª¤123ï¼‰ã€‚5 æŸ¥æ‰¾ç»“ç‚¹vçš„wé‚»æ¥ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªé‚»æ¥ç»“ç‚¹ï¼Œè½¬åˆ°æ­¥éª¤3ã€‚ å¹¿åº¦ä¼˜å…ˆè¿‡ç¨‹: 1 è®¿é—®åˆå§‹ç»“ç‚¹vå¹¶æ ‡è®°ç»“ç‚¹vä¸ºå·²è®¿é—®ã€‚2 ç»“ç‚¹vå…¥é˜Ÿåˆ—3 å½“é˜Ÿåˆ—éç©ºæ—¶ï¼Œç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™ç®—æ³•ç»“æŸã€‚4 å‡ºé˜Ÿåˆ—ï¼Œå–å¾—é˜Ÿå¤´ç»“ç‚¹uã€‚5 æŸ¥æ‰¾ç»“ç‚¹uçš„ç¬¬ä¸€ä¸ªé‚»æ¥ç»“ç‚¹wã€‚6 è‹¥ç»“ç‚¹uçš„é‚»æ¥ç»“ç‚¹wä¸å­˜åœ¨ï¼Œåˆ™è½¬åˆ°æ­¥éª¤3ï¼›å¦åˆ™å¾ªç¯æ‰§è¡Œä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š 1). è‹¥ç»“ç‚¹wå°šæœªè¢«è®¿é—®ï¼Œåˆ™è®¿é—®ç»“ç‚¹wå¹¶æ ‡è®°ä¸ºå·²è®¿é—®ã€‚ 2). ç»“ç‚¹wå…¥é˜Ÿåˆ— 3). æŸ¥æ‰¾ç»“ç‚¹uçš„ç»§wé‚»æ¥ç»“ç‚¹åçš„ä¸‹ä¸€ä¸ªé‚»æ¥ç»“ç‚¹wï¼Œè½¬åˆ°æ­¥éª¤6ã€‚ ä»£ç : 12345678910111213141516171819202122232425262728293031323334353637383940414243class Grapy(object): \"\"\"docstring for Grapy\"\"\" def __init__(self, *arg,graph=&#123;&#125;): self.graph = graph self.visited = &#123;&#125; def depth_first_traverse(self,root=None): result=[] def dft(node): self.visited[node]=True result.append(node) for n in self.graph[node]: if not n in self.visited: dft(n) if root: dft(root) return result def breadth_first_traverse(self,root=None): queue = [root] result = [root] def bft(): while queue: node = queue.pop(0) self.visited[node] = True for n in self.graph[node]: if (not n in self.visited) and (not n in queue): queue.append(n) result.append(n) if root: bft() return resultgraph = &#123;'A': ['B','C'], 'B': ['D','E'], 'C': ['F','G'], 'D': [], 'E': [], 'F':[], 'G':[]&#125;gd = Grapy(graph=graph)red = gd.depth_first_traverse('A')gb = Grapy(graph=graph)reb = gb.breadth_first_traverse('A')print('depth first traverse:',red)print('breadth first traverse:',reb) ç»“æœ:123depth first traverse: ['A', 'B', 'D', 'E', 'C', 'F', 'G']breadth first traverse: ['A', 'B', 'C', 'D', 'E', 'F', 'G'][Finished in 0.0s]","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]},{"title":"å¿«é€Ÿæ’åº-Pythonå®ç°","slug":"å¿«é€Ÿæ’åº-Pythonå®ç°","date":"2016-12-16T14:52:32.000Z","updated":"2018-03-16T14:53:54.000Z","comments":true,"path":"2016/12/16/å¿«é€Ÿæ’åº-Pythonå®ç°/","link":"","permalink":"http://yoursite.com/2016/12/16/å¿«é€Ÿæ’åº-Pythonå®ç°/","excerpt":"å¿«é€Ÿæ’åºæ˜¯ä¸€ç§é«˜æ•ˆçš„æ’åºç®—æ³•,æ˜¯ä¸€ç§å¯¹å†’æ³¡æ’åºç®—æ³•çš„æ”¹è¿›,å°½ç®¡æœ€åæƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯O(n^2),ä½†ä»å¹³å‡æ•ˆç‡æ¥çœ‹,æ—¶é—´å¤æ‚ä¸ºO(nlgn).æ‰€ä»¥å¦‚åå­—ä¸€æ ·,é€Ÿåº¦å¾ˆå¿«.","text":"å¿«é€Ÿæ’åºæ˜¯ä¸€ç§é«˜æ•ˆçš„æ’åºç®—æ³•,æ˜¯ä¸€ç§å¯¹å†’æ³¡æ’åºç®—æ³•çš„æ”¹è¿›,å°½ç®¡æœ€åæƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯O(n^2),ä½†ä»å¹³å‡æ•ˆç‡æ¥çœ‹,æ—¶é—´å¤æ‚ä¸ºO(nlgn).æ‰€ä»¥å¦‚åå­—ä¸€æ ·,é€Ÿåº¦å¾ˆå¿«. å¿«é€Ÿæ’åºçš„ä¸»è¦æ€æƒ³æ˜¯åˆ†æ²»æ€æƒ³.ä¸€åŠçš„æ­¥éª¤æ˜¯: ä»åˆ—è¡¨ä¸­ä»»æ„é€‰å–ä¸€ä¸ªæ•°ä¸ºåŸºå‡†æ•°,æ —å­ä¸­é€‰å–åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªæ•°ä¸ºåŸºå‡†æ•°å°†åˆ—è¡¨å³è¾¹å¼€å§‹éå†,é‡åˆ°æ¯”åŸºå‡†æ•°å°çš„æ•°åœä¸€ä¸‹,åœ¨ä»å·¦è¾¹å¼€å§‹éå†,é‡åˆ°æ¯”åŸºå‡†æ•°å°çš„æ•°åœä¸€ä¸‹,å°†è¿™ä¸¤ä¸ªæ•°å¯¹æ¢ä¸€ä¸‹,å¦‚6 2 7 9 3 4 5 10 8,åŸºå‡†æ•°ä¸º6,ç¬¬ä¸€æ¬¡å¯¹æ¢å°†5å’Œ7å¯¹æ¢,å°±å˜æˆäº†6 1 2 5 9 3 4 7 10 8å¦‚æ¬¡é‡å¤,å°†æ¯”6å¤§çš„æ”¾å·¦è¾¹,æ¯”6å°çš„æ”¾å·¦è¾¹,6å¤§çš„æ”¾å³è¾¹,ç±»ä¼¼äºè¿™æ ·:3 1 2 5 4 6 9 7 10 8è¿ç”¨é€’å½’,å°†6çš„å·¦è¾¹é‡å¤ç¬¬äºŒæ­¥,6çš„å³è¾¹é‡å¤ç¬¬äºŒæ­¥.çŸ¥é“å„åŒºé—´åªæœ‰ä¸€ä¸ªæ•°,æ’åºä¹Ÿå°±å®Œæˆ.ä»£ç : 1234567891011121314151617181920212223242526import randomdef qsort(arr, start, end): base = arr[start] i = start j = end while i &lt; j: while i &lt; j and arr[j] &gt;= base: j -= 1 while i &lt; j and arr[i] &lt;= base: i += 1 if(i&lt;j): arr[i], arr[j] = arr[j], arr[i] else: break arr[start] = arr[i] arr[i]=base if i - 1 &gt; start: qsort(arr, start, i - 1) if j + 1 &lt; end: qsort(arr, j + 1, end) a = [] for i in range(12): a.append(random.randint(0, 100)) print('Before quick sorted ',a) qsort(a,0,len(a)-1) print('After quick sorted: ',a) ç»“æœ: 12Before quick sorted [70, 83, 89, 72, 38, 92, 55, 64, 43, 57, 86, 73]After quick sorted: [38, 43, 55, 57, 64, 70, 72, 73, 83, 86, 89, 92]","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]},{"title":"äºŒå‰æ ‘éå†åŠè®¡ç®—æ·±åº¦-Pythonå®ç°","slug":"äºŒå‰æ ‘éå†åŠè®¡ç®—æ·±åº¦-Pythonå®ç°","date":"2016-12-11T15:00:56.000Z","updated":"2018-03-16T15:07:29.000Z","comments":true,"path":"2016/12/11/äºŒå‰æ ‘éå†åŠè®¡ç®—æ·±åº¦-Pythonå®ç°/","link":"","permalink":"http://yoursite.com/2016/12/11/äºŒå‰æ ‘éå†åŠè®¡ç®—æ·±åº¦-Pythonå®ç°/","excerpt":"é€’å½’å®ç°:","text":"é€’å½’å®ç°: ä»£ç : 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889# -*- coding:utf-8 -*-class Node(object): def __init__(self, data=None, left=None, right=None): self.data = data self.left = left self.right = rightclass BinTree(object): \"\"\"docstring for BinTree\"\"\" def __init__(self, root): self.root = root # å‰åºéå† def pretraver(self, treenode): if not treenode: return print(treenode.data) self.pretraver(treenode.left) self.pretraver(treenode.right) # ä¸­åºéå† def midtraver(self, treenode): if not treenode: return self.midtraver(treenode.left) print(treenode.data) self.midtraver(treenode.right) # ååºéå† def aftertraver(self, treenode): if not treenode: return self.aftertraver(treenode.left) self.aftertraver(treenode.right) print(treenode.data) # è®¡ç®—æ·±åº¦ def getdepth(self, treenode): if not treenode: return 0 left = 1 right = 1 left += self.getdepth(treenode.left) right += self.getdepth(treenode.right) if left &gt;= right: return left else: return right # ç»Ÿè®¡èŠ‚ç‚¹æ•°: def getsize(self, treenode): if not treenode: return 0 result = self.getsize(treenode.left) + self.getsize(treenode.right) + 1 return resultif __name__ == '__main__': root = Node('D', Node('B', Node('A'), Node('C')), Node('E', right=Node('G', Node('F', Node('H'))))) bt = BinTree(root) print('prev:') bt.pretraver(bt.root) print('mid:') bt.midtraver(bt.root) print('after:') bt.aftertraver(bt.root) print('Depth of the tree') depth = bt.getdepth(bt.root) print(depth) print('summer of nodes:') number = bt.getsize(bt.root) print(number)``` ##### éé€’å½’å®ç°:###### å‰åºç®—æ³•æ­¥éª¤:1 è®¿é—®ç»“ç‚¹p,å¹¶å°†på…¥æ ˆ2 åˆ¤æ–­pçš„å·¦ç»“ç‚¹æ˜¯å¦ä¸ºç©º,è‹¥ä¸ºç©º,åˆ™å–æ ˆé¡¶ç»“ç‚¹,å¹¶å°†å…¶å‡ºæ ˆ,ç„¶åå°†æ ˆé¡¶ç»“ç‚¹çš„å³ç»“ç‚¹ä¸ºp,å¹¶å¾ªç¯è‡³1.è‹¥ä¸ä¸ºç©º,åˆ™å°†pçš„å·¦ç»“ç‚¹ç½®ä¸ºå½“å‰ç»“ç‚¹3 ç›´åˆ°pä¸ºNone ä¸”æ ˆä¸ºç©º,åˆ™éå†ç»“æŸä»£ç :```pydef pretraver(root): p = root s = [] while p or s: while p: print(p.data) s.append(p) p = p.left if s: p = s.pop() p = p.right ä¸­åºæ ¹æ®ä¸­åºéå†çš„é¡ºåºï¼Œå¯¹äºä»»ä¸€ç»“ç‚¹ï¼Œä¼˜å…ˆè®¿é—®å…¶å·¦å­©å­ï¼Œè€Œå·¦å­©å­ç»“ç‚¹åˆå¯ä»¥çœ‹åšä¸€æ ¹ç»“ç‚¹ï¼Œç„¶åç»§ç»­è®¿é—®å…¶å·¦å­©å­ç»“ç‚¹ï¼Œç›´åˆ°é‡åˆ°å·¦å­©å­ç»“ç‚¹ä¸ºç©ºçš„ç»“ç‚¹æ‰è¿›è¡Œè®¿é—®ï¼Œç„¶åæŒ‰ç›¸åŒçš„è§„åˆ™è®¿é—®å…¶å³å­æ ‘ã€‚å› æ­¤å…¶å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼šå¯¹äºä»»ä¸€ç»“ç‚¹Pï¼Œ1)è‹¥å…¶å·¦å­©å­ä¸ä¸ºç©ºï¼Œåˆ™å°†På…¥æ ˆå¹¶å°†Pçš„å·¦å­©å­ç½®ä¸ºå½“å‰çš„Pï¼Œç„¶åå¯¹å½“å‰ç»“ç‚¹På†è¿›è¡Œç›¸åŒçš„å¤„ç†ï¼›2)è‹¥å…¶å·¦å­©å­ä¸ºç©ºï¼Œåˆ™å–æ ˆé¡¶å…ƒç´ å¹¶è¿›è¡Œå‡ºæ ˆæ“ä½œï¼Œè®¿é—®è¯¥æ ˆé¡¶ç»“ç‚¹ï¼Œç„¶åå°†å½“å‰çš„Pç½®ä¸ºæ ˆé¡¶ç»“ç‚¹çš„å³å­©å­ï¼›3)ç›´åˆ°Pä¸ºNULLå¹¶ä¸”æ ˆä¸ºç©ºåˆ™éå†ç»“æŸä¸­åº ä»£ç : 1234567891011def midtraver(root): p = root s = [] while p or s: while p: s.append(p) p=p.left if s: p = s.pop() print(p.data) p = p.right ååº:è¦ä¿è¯æ ¹ç»“ç‚¹åœ¨å·¦å­©å­å’Œå³å­©å­è®¿é—®ä¹‹åæ‰èƒ½è®¿é—®ï¼Œå› æ­¤å¯¹äºä»»ä¸€ç»“ç‚¹Pï¼Œå…ˆå°†å…¶å…¥æ ˆã€‚å¦‚æœPä¸å­˜åœ¨å·¦å­©å­å’Œå³å­©å­ï¼Œåˆ™å¯ä»¥ç›´æ¥è®¿é—®å®ƒï¼›æˆ–è€…På­˜åœ¨å·¦å­©å­æˆ–è€…å³å­©å­ï¼Œä½†æ˜¯å…¶å·¦å­©å­å’Œå³å­©å­éƒ½å·²è¢«è®¿é—®è¿‡äº†ï¼Œåˆ™åŒæ ·å¯ä»¥ç›´æ¥è®¿é—®è¯¥ç»“ç‚¹ã€‚è‹¥éä¸Šè¿°ä¸¤ç§æƒ…å†µï¼Œåˆ™å°†Pçš„å³å­©å­å’Œå·¦å­©å­ä¾æ¬¡å…¥æ ˆï¼Œè¿™æ ·å°±ä¿è¯äº†æ¯æ¬¡å–æ ˆé¡¶å…ƒç´ çš„æ—¶å€™ï¼Œå·¦å­©å­åœ¨å³å­©å­å‰é¢è¢«è®¿é—®ï¼Œå·¦å­©å­å’Œå³å­©å­éƒ½åœ¨æ ¹ç»“ç‚¹å‰é¢è¢«è®¿é—®ã€‚ ä»£ç : 1234567891011121314151617def aftertraver(root): s = [] cur = None #å½“å‰ç»“ç‚¹ pre = None #å‰ä¸€æ¬¡è®¿é—®çš„ç»“ç‚¹ s.append(root) while s: cur = s[-1] if ((not cur.left) and (not cur.right)) or (pre and (pre==cur.left or pre==cur.right)): print(cur.data) s.pop() pre = cur else: if cur.right: s.append(cur.right) if cur.left: s.append(cur.left)","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]},{"title":"å½’å¹¶æ’åº-Pythonå®ç°","slug":"å½’å¹¶æ’åº-Pythonå®ç°","date":"2016-11-16T14:55:04.000Z","updated":"2018-03-16T14:56:27.000Z","comments":true,"path":"2016/11/16/å½’å¹¶æ’åº-Pythonå®ç°/","link":"","permalink":"http://yoursite.com/2016/11/16/å½’å¹¶æ’åº-Pythonå®ç°/","excerpt":"å½’å¹¶æ’åºä¹Ÿæ˜¯åˆ†æ²»æ€æƒ³çš„ä¸€ä¸ªå…¸å‹åº”ç”¨,æ€è·¯æ˜¯å…ˆå°†æ•°åˆ—é€’å½’åˆ†è§£,å¦‚å°†æ•°åˆ—åˆ†è§£æˆA,B.å†å°†A,Bå„è‡ªåˆ†è§£æˆä¸¤ä¸ªæ•°åˆ—,ä¾æ¬¡ç±»æ¨,å½“åˆ†å‡ºæ¥çš„å°ç»„åªæœ‰ä¸€ä¸ªæ•°æ—¶ï¼Œå¯ä»¥è®¤ä¸ºå°ç»„ç»„å†…å·²ç»æœ‰åºå•¦ï¼ç„¶åå°±æ˜¯è€ƒè™‘æ€ä¹ˆå°†ä¸¤ä¸ªæœ‰åºæ•°ç»„åˆå¹¶ï¼æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç¬¬ä¸‰æ–¹æ•°ç»„ï¼£,","text":"å½’å¹¶æ’åºä¹Ÿæ˜¯åˆ†æ²»æ€æƒ³çš„ä¸€ä¸ªå…¸å‹åº”ç”¨,æ€è·¯æ˜¯å…ˆå°†æ•°åˆ—é€’å½’åˆ†è§£,å¦‚å°†æ•°åˆ—åˆ†è§£æˆA,B.å†å°†A,Bå„è‡ªåˆ†è§£æˆä¸¤ä¸ªæ•°åˆ—,ä¾æ¬¡ç±»æ¨,å½“åˆ†å‡ºæ¥çš„å°ç»„åªæœ‰ä¸€ä¸ªæ•°æ—¶ï¼Œå¯ä»¥è®¤ä¸ºå°ç»„ç»„å†…å·²ç»æœ‰åºå•¦ï¼ç„¶åå°±æ˜¯è€ƒè™‘æ€ä¹ˆå°†ä¸¤ä¸ªæœ‰åºæ•°ç»„åˆå¹¶ï¼æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç¬¬ä¸‰æ–¹æ•°ç»„ï¼£, éå†æ¯”è¾ƒä¸¤æ•°ç»„ï¼Œè°å°å°±å–è°ï¼Œæ”¾å…¥ï¼£æ•°ç»„ä¸­ï¼Œå–å®Œå¾€åç§»ä¸€ä¸ªå†æ¯”è¾ƒï¼å¦‚æœæŸä¸ªæ•°ç»„å–å®Œå•¦ï¼ŒæŠŠå¦å¤–ä¸€ä¸ªæ•°ç»„å‰©ä¸‹çš„å…¨éƒ¨æ”¾è¿›ï¼£æ•°ç»„å³å¯ï¼ ä»£ç  12345678910111213141516171819202122232425262728293031import random#åˆå¹¶å‡½æ•°def merge(a,b): c = [] i=j=0 while i&lt;len(a) and j&lt;len(b): if a[i]&lt;b[j]: c.append(a[i]) i+=1 else: c.append(b[j]) j+=1 if i&lt;len(a): c+=a[i:] if j&lt;len(b): c+=b[j:] return cdef mergesort(arr): if len(arr)&lt;=1: return arr mid = int(len(arr)/2) a = mergesort(arr[:mid]) b = mergesort(arr[mid:]) return merge(a,b)if __name__ == '__main__': arr = [] for i in range(15): arr.append(random.randint(0, 100)) print('Before merge sorted ',arr) result = mergesort(arr) print('After merge sorted: ',result) ç»“æœï¼š 12Before merge sorted [53, 100, 26, 47, 3, 31, 40, 34, 75, 67, 66, 10, 29, 70, 73]After merge sorted: [3, 10, 26, 29, 31, 34, 40, 47, 53, 66, 67, 70, 73, 75, 100]","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]},{"title":"Pythonå¹¶å‘ç¼–ç¨‹ä¹‹çº¿ç¨‹æ€»ç»“","slug":"Pythonå¹¶å‘ç¼–ç¨‹ä¹‹çº¿ç¨‹æ€»ç»“","date":"2016-11-16T14:09:38.000Z","updated":"2018-03-16T14:15:41.000Z","comments":true,"path":"2016/11/16/Pythonå¹¶å‘ç¼–ç¨‹ä¹‹çº¿ç¨‹æ€»ç»“/","link":"","permalink":"http://yoursite.com/2016/11/16/Pythonå¹¶å‘ç¼–ç¨‹ä¹‹çº¿ç¨‹æ€»ç»“/","excerpt":"ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºå¯ä»¥æˆä¸ºä¸€ä¸ªè¿›ç¨‹,æ¯ä¸ªè¿›ç¨‹ç®¡ç†è€…ä»–è‡ªå·±çš„ç³»ç»ŸçŠ¶æ€.æ¯”å¦‚æ‰“å¼€ä¸€ä¸ªæ’­æ”¾å™¨æ¥å¬å¬æ­Œ,æ’­æ”¾å™¨è¿™ä¸ªè¿è¡Œçš„ç¨‹åºå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹.","text":"ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºå¯ä»¥æˆä¸ºä¸€ä¸ªè¿›ç¨‹,æ¯ä¸ªè¿›ç¨‹ç®¡ç†è€…ä»–è‡ªå·±çš„ç³»ç»ŸçŠ¶æ€.æ¯”å¦‚æ‰“å¼€ä¸€ä¸ªæ’­æ”¾å™¨æ¥å¬å¬æ­Œ,æ’­æ”¾å™¨è¿™ä¸ªè¿è¡Œçš„ç¨‹åºå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹.è¿›ç¨‹ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„,ä½†æ„Ÿè§‰ä¸€ä¸ªå¬æ­Œæ—¶,æˆ‘ä»¬ä¸€è¾¹å¬ç€æ­Œå£°,ä¸€è¾¹çœ‹çœ‹æ­Œè¯,ä¸€è¾¹è¿˜åˆ·åˆ·è¯„è®º,ä»¿ä½›æœ‰å‡ ä¸ªä»»åŠ¡åœ¨åŒæ—¶è¿è¡Œç€,è¿™ä¸€ä¸ªä¸ªçš„å­ä»»åŠ¡,å°±æ˜¯ä¸€ä¸ªä¸ªè¿›ç¨‹åˆ›å»ºå‡ºæ¥çš„çº¿ç¨‹,å½“ç„¶,ç¨‹åºè¦è¿è¡Œ,è‡³å°‘è¦æœ‰ä¸€ä¸ªçº¿ç¨‹.è¿›ç¨‹å’Œçº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿçš„è°ƒåº¦ä¸‹,ä¸æ–­çš„åˆ‡æ¢,ç”±äºæ—¶é—´æçŸ­,æ„Ÿè§‰æ˜¯åœ¨åŒæ—¶è¿è¡Œçš„.å¤šä¸ªç¨‹åºåŒæ—¶è¿è¡Œ,ä¹Ÿå«å¹¶è¡Œ,çœŸæ­£çš„å¹¶è¡Œéœ€è¦è¿è¡Œåœ¨å¤šæ ¸CPUä¸Š,æ­£å› ä¸ºè¿›ç¨‹å’Œçº¿ç¨‹çš„ä¸æ–­åˆ‡æ¢,æ“ä½œç³»ç»Ÿä¹Ÿä¼šè‡ªåŠ¨æŠŠå¾ˆå¤šä»»åŠ¡è½®æµè°ƒåº¦åˆ°æ¯ä¸ªæ ¸å¿ƒä¸Šæ‰§è¡Œ,åœ¨æ—©æœŸçš„å•æ ¸CPUç”µè„‘æ—¶,æˆ‘ä»¬ä¹Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºæˆ–ä»»åŠ¡.åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­,å¤šä¸ªçº¿ç¨‹åŒæ—¶æ›´æ–°åŒä¸€ä¸ªæ•°æ®ç»“æ„æ—¶å®¹æ˜“é€ æˆèµ„æºç«äº‰,è¿™æ—¶éœ€è¦å¼•å…¥äº’æ–¥é”ç­‰æœºåˆ¶æ¥ä¿æŒæ•°æ®çš„åŒæ­¥.æ¯”å¦‚å¤šä¸ªçº¿ç¨‹å¾€ä¸€ä¸ªæ–‡ä»¶é‡Œå†™ä¸œè¥¿,å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™,é‚£ä¸ä¹±å¥—äº†å—,éœ€è¦é”æ¥ä¿æŒä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å†™å…¥,å¤šä¸ªçº¿ç¨‹ä¾æ¬¡æ‰§è¡Œ. è¿™é‡Œå†è¯´ä¸€ä¸‹å¹¶è¡Œå’Œå¹¶å‘çš„åŒºåˆ«,å¹¶è¡Œæ˜¯åŒæ—¶è¿è¡Œ,åªæœ‰åœ¨å¤šæ ¸cpuä¸Šæ‰èƒ½çœŸæ­£å®ç°,è€Œå¹¶å‘æ˜¯æŒ‡åœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…,å¤šä¸ªäº‹ä»¶å‘ç”Ÿ,å°±å¥½æ¯”åšå¥½åƒçš„æ—¶,æˆ‘å¯ä»¥å…ˆç‚’ç‚’èœ,ç„¶åæ´—å»é‚£ä¸ªè°ƒå‘³å“,å›æ¥ç»§ç»­ç‚’,ç„¶ååˆå»æ´—æ´—ä¸‹ä¸€ä¸ªèœçš„ææ–™,ç„¶ååˆç¿»ä¸¤ä¸‹é”…é‡Œ.ä¸€ä¸ªæ—¶é—´é—´éš”å†…,åˆ‡æ¢ç€åšäº†å¤šä»¶äº‹,å…¶å®åŒä¸€ä¸ªæ—¶é—´ç‚¹,åªåšä¸€ä»¶äº‹.åœ¨ç½‘ç»œæœåŠ¡å™¨ä¸Š,å¹¶å‘ä¹ŸæŒ‡èƒ½åŒæ—¶å¤„ç†çš„è¿æ¥æ•°,æ¯”å¦‚ä¸€ä¸ªæœåŠ¡å™¨èƒ½åŒæ—¶å¤„ç†1000ä¸ªTCPé“¾æ¥,è¿™ä¸ªæœåŠ¡å™¨çš„å¹¶å‘é‡å°±æ˜¯1000,å°½ç®¡æœåŠ¡å™¨å¯èƒ½åªæ˜¯åŒæ ¸æˆ–4æ ¸çš„. Pythonåœ¨å¤§éƒ¨åˆ†ç³»ç»Ÿä¸Šéƒ½æ”¯æŒä¸åŒå½¢å¼çš„å¹¶å‘ç¼–ç¨‹.ä¸€èˆ¬ä¸ºä¸‰ç§:å¤šè¿›ç¨‹,å¤šçº¿ç¨‹,åç¨‹.å¯¹äºå¤šè¿›ç¨‹,è¿˜æ²¡æœ‰å»å¥½å¥½ç ”ç©¶,å…ˆæ€»ç»“ä¸€ä¸‹å¤šçº¿ç¨‹å’Œåç¨‹å§. å¤šçº¿ç¨‹ å¤§å¤šæ•°äººå¯¹å¤šçº¿ç¨‹æ¯”è¾ƒç†Ÿæ‚‰,Javaç­‰è¯­è¨€éƒ½æ”¯æŒçš„å¾ˆå¥½,å¯ä»¥å°†å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œåœ¨å¤šä¸ªæ ¸å¿ƒä¸Š,å¹¶ä¿è¯çº¿ç¨‹å®‰å…¨.è›‹ç–¼çš„æ˜¯Pythonå› ä¸ºå†å²åŸå› ,å¤šçº¿ç¨‹æœºåˆ¶æœ‰ç€é™åˆ¶,ä¸ºäº†ä¿è¯è¿è¡Œçº¿ç¨‹å®‰å…¨,Cpythonè§£é‡Šå™¨(GIL)å¼•å…¥äº†å†…éƒ¨å…¨å±€è§£é‡Šå™¨é”è¿™æ ·ä¸€ä¸ªä¸œè¥¿,è€ŒCpythonæ˜¯å¤§éƒ¨åˆ†ç¯å¢ƒä¸‹é»˜è®¤çš„Pythonç¨‹åºæ‰§è¡Œç¯å¢ƒ,GILåŒæ—¶åªå…è®¸ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ,å“ªæ€•ç¨‹åºåœ¨å¤šæ ¸å¤„ç†å™¨çš„è®¡ç®—æœºä¸Šä¹Ÿåªèƒ½åœ¨è¿è¡Œåœ¨å•ä¸ªå¤„ç†å™¨ä¸Š,è¿™ä¹Ÿæ˜¯GILäº‰è®ºæœ€å¤šçš„åœ°æ–¹,å½“ç„¶å¤šçº¿ç¨‹å°½ç®¡åœ¨æ€§èƒ½ä¸Šä¸å¤ªè¡Œ,ä½†å®ƒè¿˜æ˜¯æœ‰å®ƒå¯ä»¥å¹¶å‘æ‰§è¡Œç¨‹åºçš„ä¼˜ç‚¹.è€Œä¸”Pythonæä¾›çš„threadingç­‰æ¨¡å—ä¹Ÿä½¿å†™å¤šçº¿ç¨‹ç¨‹åºå˜å¾—éå¸¸ç®€å•,è¿™ä¹Ÿå°±æ˜¯Pythonçš„é£æ ¼.æ¥çœ‹çœ‹å¤šçº¿ç¨‹çš„ç”¨æ³•å§! æœ€æœ€æœ€ç®€å•çš„: 123456import threadingdef hello(): print('hello')t = threading.Thread(target=hello)t.start()t.join() ç¨‹åºè¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸Š,åˆ›å»ºä¸€ä¸ªThreadå®ä¾‹ä¹Ÿå°±æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹,targetå‚æ•°ä¼ å…¥éœ€è¦é€šè¿‡æ–°çº¿ç¨‹å¤„ç†çš„å‡½æ•°å.é€šè¿‡æ–°çº¿ç¨‹çš„startæ–¹æ³•å¯åŠ¨è¿™ä¸ªæ–°çº¿ç¨‹,æ–°çº¿ç¨‹çš„å‡½æ•°å¼€å§‹æ‰§è¡Œ.joinæ–¹æ³•ä¼šç­‰å¾…è°ƒç”¨joinçš„çº¿ç¨‹æ‰§è¡Œå®Œå,å†å›åˆ°ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œ.å½“ç„¶joinè¿˜å¯ä»¥ä¼ å…¥ä¸€ä¸ªTimeout,åƒè¿™æ ·t.join(0.5),å¯åŠ¨çº¿ç¨‹å,åœ¨0.5sçš„æ—¶é—´å†…,å¦‚æœçº¿ç¨‹æœªæ‰§è¡Œå®Œ,ä¹Ÿä¼šç»ˆæ­¢è¿™ä¸ªçº¿ç¨‹,è·³å…¥ä¸‹ä¸€ä¸ªçº¿ç¨‹æˆ–ä¸»çº¿ç¨‹. ä¹Ÿå¯ä»¥é€šè¿‡é‡è½½Threadçš„runæ–¹æ³•æ¥è¾¾åˆ°åŒæ ·çš„ç›®çš„.è¿™æ · 123456import threadingclass MyThread(threading.Thread): def run(self): print('æˆ‘åœ¨æ–°çº¿ç¨‹ä¸­å“Ÿ!')t = MyThread()t.start() çº¿ç¨‹åœ¨å¹¶å‘æ—¶è¿è¡Œæ•ˆç‡å¯ä»¥å¤§å¤§çš„æé«˜,çœ‹ä¸‹é¢è¿™ä¸ªæ —å­:å•çº¿ç¨‹: 12345678910111213import threadingimport timedef thfun(): s = 0 for i in range(30): s += i time.sleep(0.1) print(s)if __name__ == '__main__': t = time.time() thfun() thfun() print('å•çº¿ç¨‹è¿è¡Œæ—¶é—´:',time.time()-t) è¿è¡Œç»“æœ: 1234435435å•çº¿ç¨‹è¿è¡Œæ—¶é—´: 6.008038520812988[Finished in 6.0s] å¤šçº¿ç¨‹: 12345678910111213141516import threadingimport timedef thfun(): s = 0 for i in range(30): s += i time.sleep(0.1) print(s)if __name__ == '__main__': ths = [threading.Thread(target=thfun) for i in range(2)] for th in ths: th.start() t = time.time() for th in ths: th.join() print('å¤šçº¿ç¨‹è¿è¡Œæ—¶é—´:',time.time()-t) è¿è¡Œç»“æœ: 1234435435å¤šçº¿ç¨‹è¿è¡Œæ—¶é—´: 3.0041489601135254[Finished in 3.1s] è¿›é˜¶å®ˆæŠ¤çº¿ç¨‹:å¦‚æœå°†çº¿ç¨‹aè®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹,è®¾ç½®æ–¹æ³•æœ‰a.daemon=Trueå’Œa.setDaemon(True).åœ¨ä¸»çº¿ç¨‹ç»“æŸæ—¶,æ— è®ºaçº¿ç¨‹æ˜¯å¦ç»“æŸ,éƒ½ä¼šéšä¸»çº¿ç¨‹ä¸€èµ·é€€å‡º.ç¨‹åºè¿è¡Œä¸­ï¼Œæ‰§è¡Œä¸€ä¸ªä¸»çº¿ç¨‹ï¼Œå¦‚æœä¸»çº¿ç¨‹åˆåˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹å°±åˆ†å…µä¸¤è·¯ï¼Œåˆ†åˆ«è¿è¡Œï¼Œé‚£ä¹ˆå½“ä¸»çº¿ç¨‹å®Œæˆæƒ³é€€å‡ºæ—¶ï¼Œä¼šæ£€éªŒå­çº¿ç¨‹æ˜¯å¦å®Œæˆã€‚å¦‚æœå­çº¿ç¨‹æœªå®Œæˆï¼Œåˆ™ä¸»çº¿ç¨‹ä¼šç­‰å¾…å­çº¿ç¨‹å®Œæˆåå†é€€å‡ºã€‚ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦çš„æ˜¯ï¼Œåªè¦ä¸»çº¿ç¨‹å®Œæˆäº†ï¼Œä¸ç®¡å­çº¿ç¨‹æ˜¯å¦å®Œæˆï¼Œéƒ½è¦å’Œä¸»çº¿ç¨‹ä¸€èµ·é€€å‡ºï¼Œè¿™æ—¶å°±å¯ä»¥ç”¨setDaemonæ–¹æ³•äº†ã€‚æ¥çœ‹çœ‹æ —å­å§:ç¨‹åº: 12345678910111213141516import threading,timedef daefun(): print('daemon start...') time.sleep(2) print('daemon end.')def ndaefun(): print('ndaemon start...') time.sleep(1) print('ndaemon end.')d = threading.Thread(target=daefun)d.daemon = Truen = threading.Thread(target=ndaefun)print('main start...')d.start()n.start()print('main end.') ç»“æœ: 123456main start...daemon start...ndaemon start...main end.ndaemon end.[Finished in 1.0s å¹¶æ²¡æœ‰çœ‹åˆ°æ‰“å°â€™daemon end!â€™å› ä¸ºä¸»ç¨‹åºæ‰§è¡Œå®Œå,å®ˆæŠ¤çº¿ç¨‹è¿˜æ²¡æ‰§è¡Œå®Œ,ä¹Ÿè·Ÿç€ç»“æŸå•¦,æœ‰ç‚¹æ„Ÿè§‰å’Œjoin()æ–¹æ³•ç›¸å,è€Œéå®ˆæŠ¤çº¿ç¨‹,åœ¨ä¸»ç¨‹åºç»“æŸæ—¶,ä¾ç„¶ä¼šæ‰§è¡Œå®Œ. çº¿ç¨‹äº’æ–¥é”çº¿ç¨‹é”çš„ä½œç”¨æ˜¯ä¿è¯åœ¨å¤šçº¿ç¨‹ä¸­,è®©åŒä¸€å—æ•°æ®åœ¨åŒä¸€æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æ“ä½œ,è¦ä¸æ•°æ®å°±å®¹æ˜“ä¹±å¥—,æ‰€ä»¥å¼•å…¥é”çš„æœºåˆ¶.å°±å¥½æ¯”ä¸€ä¸ªå…¨å°ä¿¡ç®±,å¾ˆå¤šäººæƒ³å–ä¿¡æˆ–æ”¾ä¿¡.ä¸ºäº†é˜²æ­¢å‡ºé”™,ä¸€æ¬¡åªèƒ½å»ä¸€ä¸ªäºº,äºæ˜¯è¿™ä¸ªäººè¹¦è¹¦è·³è·³çš„å»å–äº†è¦æ˜¯,å¼€å®Œé”å®Œæˆæ“ä½œä»¥å,å°†ä¿¡ç®±é”ä¸Š,å†å°†è¦æ˜¯æ”¾å›åŸå¤„,ä¸‹ä¸€ä¸ªäººæœ‰è¹¦è¹¦è·³è·³çš„å»å–é’¥åŒ™,æ‰“å¼€ä¿¡ç®±,æ“ä½œ.ä»£ç : 123456789101112131415161718192021import threading,timeshare = 4class MyThread(threading.Thread): def __init__(self,i): super().__init__() self.i = i def run(self): global share for d in range(3): lock.acquire() print(share) share += self.i time.sleep(0.3) print('+',self.i,'=',share) lock.release()lock = threading.Lock()if __name__ == '__main__': t = MyThread(2) tt = MyThread(6) t.start() tt.start() è¿è¡Œç»“æœ: 123456789101112134+ 2 = 66+ 2 = 88+ 2 = 1010+ 6 = 1616+ 6 = 2222+ 6 = 28[Finished in 2.9s] æ“ä½œæ•°æ®æ—¶,å¿é€šè¿‡acquire()æ–¹æ³•è·å–é”,è·å–ååœ¨é‡Šæ”¾ä¹‹å‰,å› ä¸ºé”åªæœ‰ä¸€æŠŠ,å…¶ä»–çº¿ç¨‹æ— æ³•æ“ä½œè¿™å—æ•°æ®.ç›´åˆ°é€šè¿‡release()æ–¹æ³•é‡Šæ”¾é”,å…¶ä»–çº¿ç¨‹æ‰èƒ½è·å¾—é”,æ“ä½œæ•°æ®.é”æœºåˆ¶å›ºç„¶å¥½,ä½†è¦æ³¨æ„é¿å…æ­»é”.åœ¨çº¿ç¨‹é—´å…±äº«å¤šä¸ªèµ„æºçš„æ—¶å€™ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«å æœ‰ä¸€éƒ¨åˆ†èµ„æºå¹¶ä¸”åŒæ—¶ç­‰å¾…å¯¹æ–¹çš„èµ„æºï¼Œå°±ä¼šé€ æˆæ­»é” Conditionå¯¹è±¡Pythonæä¾›çš„Conditionå¯¹è±¡æä¾›äº†å¯¹å¤æ‚çº¿ç¨‹åŒæ­¥é—®é¢˜çš„æ”¯æŒã€‚Conditionè¢«ç§°ä¸ºæ¡ä»¶å˜é‡ï¼Œé™¤äº†æä¾›ä¸Lockç±»ä¼¼çš„acquireå’Œreleaseæ–¹æ³•å¤–ï¼Œè¿˜æä¾›äº†waitå’Œnotifyæ–¹æ³•ã€‚ æ —å­:ç”Ÿäº§è€…é€šè¿‡åˆ¤æ–­æ˜¯å¦ç”Ÿäº§,æ¶ˆè´¹è€…é€šè¿‡åˆ¤æ–­æ˜¯å¦æ¶ˆè´¹. 123456789101112131415161718192021222324252627282930313233343536import threading,timeshare = 0share_cond = threading.Condition()class ProThread(threading.Thread): def __init__(self,): super().__init__() self.name = 'Produce' def run(self): global share if share_cond.acquire(): while True: if not share: share += 1 print(self.name,share) share_cond.notify() share_cond.wait() time.sleep(0.3)class CustomThread(threading.Thread): def __init__(self): super().__init__() self.name = 'Custom' def run(self): global share if share_cond.acquire(): while True: if share: share -= 1 print(self.name,share) share_cond.notify() share_cond.wait() time.sleep(0.3)if __name__ == '__main__': t = ProThread() t.start() tt = CustomThread() tt.start() ç»“æœ: 123456789101112131415Produce 1Custom 0Produce 1Custom 0Produce 1Custom 0Produce 1Custom 0Produce 1Custom 0Produce 1Custom 0Produce 1Custom 0.....","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]},{"title":"numpyç¬”è®°","slug":"numpyå­¦ä¹ ç¬”è®°","date":"2016-10-11T14:09:38.000Z","updated":"2018-03-16T14:18:22.000Z","comments":true,"path":"2016/10/11/numpyå­¦ä¹ ç¬”è®°/","link":"","permalink":"http://yoursite.com/2016/10/11/numpyå­¦ä¹ ç¬”è®°/","excerpt":"è®°å½•ä¸€ä¸‹numpyä¸€äº›å‡½æ•°çš„ä½¿ç”¨","text":"è®°å½•ä¸€ä¸‹numpyä¸€äº›å‡½æ•°çš„ä½¿ç”¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991:æŒ‡å®šæ•°æ®ç±»å‹ï¼šdtype=''2:æ”¹å˜æ•°ç»„ç»´åº¦ a:å¦‚ï¼šb=np.arange(24).reshape(2,3,4) b:å±•å¹³ï¼Œå˜æˆä¸€ç»´ b.ravel() æˆ– b.flatten() flattenä¼šè¯·æ±‚åˆ†é…å†…å­˜æ¥ä¿å­˜ç»“æœ c:è½¬ç½® b.transpose() æˆ–b.T d:b.resize((2,12))å’Œreshape()3:æ•°ç»„çš„ç»„åˆï¼ša:æ°´å¹³ç»„åˆï¼šnp.hstack((a,b))æˆ–np.concatenate((a,b),axis=1) b:å‚ç›´ç»„åˆï¼šnp.vstack((a,b))æˆ–npconcatenate((a,b),axis=0) c:æ·±åº¦ç»„åˆï¼šnp.dstack((a,b)4:æ•°ç»„åˆ†å‰²ï¼ša:æ°´å¹³åˆ†å‰²ï¼šnp.hsplit(a,3) æˆ– np.split(a,3,axis=1) åˆ†å‰²æˆä¸‰åˆ— b:å‚ç›´åˆ†å‰²ï¼šnp.vsplit(a,3) æˆ–np.split(a,3,axis=0) c:æ·±åº¦åˆ†å‰²ï¼šnp.dsplit(c,3)5:æ•°ç»„çš„å±æ€§ï¼š.ndimå±æ€§ åˆ—å‡ºæ•°ç»„çš„çº¬åº¦ .sizeå±æ€§ åˆ—å‡ºæ•°ç»„å…ƒç´ çš„æ€»ä¸ªæ•° .itemsize å…ƒç´ åœ¨å†…å­˜ä¸­æ‰€å çš„å­—èŠ‚æ•° .nbytes æ•°ç»„æ‰€å å­˜å‚¨ç©ºé—´ .T è½¬ç½® .real å¤æ•°æ•°ç»„çš„å®éƒ¨ .imag å¤æ•°æ•°ç»„çš„è™šéƒ¨6ï¼šå¸¸ç”¨å‡½æ•° a: np.eye(3) å•ä½çŸ©é˜µï¼š b: np.savetxt(\"eye.txt\",a) æ•°æ®å­˜å‚¨ c: c,v = np.loadtxt('data.csv',delimiter=',',usecols=(6,7),unpack=True)è¯»å…¥CSVæ–‡ä»¶ï¼š d: np.average(c,weights=v)åŠ æƒå¹³å‡æ•° e: np.mean(c) ç®—æ•°å¹³å‡æ•° f: np.max() np.min() æœ€å¤§å€¼æœ€å°å€¼ g: np.ptn()æ•°ç»„èŒƒå›´ï¼Œå³æœ€å¤§å€¼æœ€å°å€¼ä¹‹å·®ï¼š h: np.median()ä¸­ä½æ•°ï¼š i: np.msort()æ’åºï¼š j: np.var()æ–¹å·®ï¼š k: np.std()æ ‡å‡†å·®ï¼š l: np.diff()æ•°ç»„ç›¸é‚»å…ƒç´ çš„å·®å€¼æ„æˆçš„æ•°ç»„ m: np.log()è‡ªç„¶å¯¹æ•°In : n: np.where(c&gt;2)ç­›é€‰: æ ¹æ®æŒ‡å®šçš„æ¡ä»¶è¿”å›æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„æ•°ç»„å…ƒç´ çš„ç´¢å¼•å€¼ o: np.take(m,indexarray)è·å–ç´¢å¼•å€¼ç›¸å¯¹åº”çš„å…ƒç´ è´¨ï¼š p: np.argmax å’Œ np.argmin è¿”å›æ•°ç»„ä¸­æœ€å¤§å’Œæœ€å°å…ƒç´ çš„ç´¢å¼•å€¼ q: np.maximum(a,b,c)è¿”å›abc ä¹‹ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„æœ€å¤§å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ çš„æœ€å¤§å€¼ã€‚ã€‚ã€‚ r: np.ones() å…¨æ˜¯1çš„æ•°ç»„ s: np.convolve(weights,c) å·ç§¯ t: np.exp(x) æŒ‡æ•°å‡½æ•° å³e**x u: np.linspace(f,e,s)æ ¹æ®èµ·å§‹å€¼ï¼Œç»ˆæ­¢å€¼ï¼Œæ­¥é•¿äº§ç”Ÿä¸€ä¸ªæ•°ç»„ v: a.fill(8) å°†açš„å€¼å…¨éƒ¨è®¾ä¸º8 w: np.linalg.lstsq(A,y)[0] æ±‚è§£Ap = y pçš„å€¼ æ±‚è§£å¤šå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ x: np.dot(a,b) ï½ï½‚çš„ä¹˜ç§¯ y: np.intersectld(a,b) abæ•°ç»„çš„ï½€ç›¸åŒå…ƒç´  z: a.clip(1,2) ä¿®å‰ªæ•°ç»„ æ¯”ï¼‘å°çš„éƒ½æ¢æˆï¼‘ï¼Œæ¯”ï¼’å¤§çš„éƒ½æ¢æˆï¼’ a.compress(a&gt;2) è¿”å›æ»¡è¶³æ¡ä»¶çš„æ•°ç»„å…ƒç´  b.prod() bä¸­å„å…ƒç´ ç›¸ä¹˜ å’Œarangeç»“åˆå¯ä»¥æ±‚é˜¶ä¹˜ b.cumprod è¿”å›ï½‚ä¸­å„å…ƒç´ çš„ç´¯ç§¯ä¹˜ç§¯7:ä¾¿æ·å‡½æ•°: np.cov(X,Y) æ±‚ä¸¤çŸ©é˜µçš„åæ–¹å·® a.diagonal() æ±‚å¯¹è§’çº¿ä¸Šçš„å…ƒç´  a.trace() æ±‚çŸ©é˜µè¿¹,å¯¹è§’çº¿ä¸Šå…ƒç´ ä¹‹å’Œ np.corrcoef(a,b) ç›¸å½“äºcovariance / (a.std() * b.std()) ä¸¤å‘é‡ç›¸å…³ç³»æ•°ä¸ºåæ–¹å·®é™¤ä¸¤æ ‡å‡†å·®çš„ä¹˜ç§¯ np.ployfit(x,y,3) æ‹Ÿåˆ,ç”¨ä¸‰æ¬¡å¤šé¡¹å¼ å¾—åˆ°å¤šé¡¹å¼çš„ç³»æ•°poly np.polyval(poly,x[-1]+1) æ¨æ–­ä¸‹ä¸€ä¸ªå€¼ np.roots(poly) æ±‚å¤šé¡¹å¼çš„æ ¹ np.polyder(poly) æ±‚å¤šé¡¹å¼å¯¼å‡½æ•° np.sign() è¿”å›å…ƒç´ ç¬¦å·,æ­£ä¸º1 è´Ÿä¸º-1 np.piecewise() åˆ†æ®µç»™å®šå€¼ å¦‚ np.piecewise(x, [x &lt; 0, x &gt;= 0], [lambda x: -x, lambda x: x]) æˆ–: np.piecewise(x, [x &lt; 0, x &gt;= 0], [-1, 1]) np.array_equal(a,b) æ£€éªŒä¸¤æ•°ç»„æ˜¯å¦ç›¸åŒ vfunc=np.vertorize(func) åˆ†åˆ«ä½œç”¨äºä¸€ä¸ªå‡½æ•°,ç›¸å½“äºPythonçš„mapå‡½æ•° np.hanning(N) è®¡ç®—æƒé‡,ç”Ÿæˆé•¿åº¦ä¸ºNçš„çª—å£ np.polysub(a,b) å¯¹å¤šé¡¹å¼ç›¸å‡ np.isreal() åˆ¤æ–­æ•°ç»„æ˜¯å¦ä¸ºå®æ•° np.select(condlist, choicelist) æ ¹æ®æ¡ä»¶ç­›é€‰8:çŸ©é˜µå’Œé€šç”¨å‡½æ•°ï¼š A = np.mat('1 2 3;4 5 6;7 8 9') åˆ›å»ºçŸ©é˜µ A.T A.Iè½¬ç½®çŸ©é˜µå’Œé€†çŸ©é˜µ np.bmat(\"A B;A B\")åˆ›å»ºåˆ†å—å¤åˆçŸ©é˜µ np.frompyfunc(func, nin, nout) åˆ›å»ºé€šç”¨å‡½æ•° nin:è¾“å…¥å‚æ•°ä¸ªæ•°ï¼Œnoutè¾“å‡ºå¯¹è±¡ä¸ªæ•° é€šç”¨å‡½æ•°çš„å››ä¸ªæ–¹æ³•ï¼š reduce æ²¿ç€æŒ‡å®šçš„è½´ï¼Œé€’å½’ä½œç”¨äºæ•°ç»„ï¼Œ accumulate å’Œreduceçš„åŒºåˆ«æ˜¯ä¼šè¿”å›ä¸­é—´å€¼ reduceat outer np.divide(a,b) é™¤æ³•ï¼Œç»“æœåªä¿ç•™æ•´æ•°éƒ¨åˆ† np.true_divide(a,b) é™¤æ³•ï¼Œç»“æœä¿ç•™å°æ•° np.floor_divide() é™¤æ³•ï¼Œåªä¿ç•™æ•´æ•°ç»“æœï¼Œä½†åŠ . np.remainder() è¿”å›ä¸¤æ•°ç»„ç›¸å¤„åçš„ä½™æ•° 9:linalgæ¨¡å— np.linalg,inv(a) æ±‚é€†çŸ©é˜µ np.linalg.solve(A,b) æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ np.linalg.eigvals() æ±‚ç‰¹å¾å€¼ m,n=np.linalg.eig(A) æ±‚ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ np.linalg.pinv() æ±‚å¹¿ä¹‰é€†çŸ©é˜µ np.linalg.det(A) è®¡ç®—çŸ©é˜µçš„è¡Œåˆ—å¼ 10ï¼šfftæ¨¡å— np.fft.fft(a) æ±‚å‚…é‡Œå¶å˜æ¢ np.fft.fftshift() å‚…é‡Œå¶å˜æ¢åç§»é¢‘ np.fft.ifftshift() ç§»é¢‘é€†æ“ä½œ np.random.binomial(n,p,size) è®¡ç®—äºŒé¡¹å¼åˆ†å¸ƒ np.random.hypergeometric(ngood, nbad, nsample, size=None) è¶…å‡ ä½•åˆ†å¸ƒ np.random.normal(size=N) æ­£å¤ªåˆ†å¸ƒ np.random.lognormal(size=N) å¯¹æ•°æ­£å¤ªåˆ†å¸ƒ11ï¼šä¸“ç”¨å‡½æ•°ï¼š np.searchsorted(a, v, side='left') åœ¨æ•°ç»„aä¸­æ’å…¥å€¼vï¼Œè¿”å›våœ¨æ•°ç»„ä¸­çš„ä½ç½® np.lexsort(a,b) å…ˆæ ¹æ®aï¼Œè‹¥ç›¸åŒæ ¹æ®bæ¥æ’åºã€‚a,bæŒ‰ç´¢å¼•å€¼å¯¹åº”ã€‚ np.i0() ç¬¬ä¸€ç±»ä¿®æ­£çš„é›¶é˜¶è´å¡å°”å‡½æ•° np.sinc() sincå‡½æ•°","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]},{"title":"socketæ‘˜å½•","slug":"socketæ‘˜å½•","date":"2016-08-16T14:31:37.000Z","updated":"2018-03-16T14:49:36.000Z","comments":true,"path":"2016/08/16/socketæ‘˜å½•/","link":"","permalink":"http://yoursite.com/2016/08/16/socketæ‘˜å½•/","excerpt":"å¯é‡ç”¨å¥—æ¥å­—å½“è¿æ¥è¢«æœ‰æ„æ— æ„å…³é—­æ—¶ï¼Œä½†æ­¤æ—¶ç«¯å£è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œè¦ç»è¿‡ä¸€ä¸ªTIME_WAITçš„è¿‡ç¨‹ä¹‹åæ‰èƒ½ä½¿ç”¨ã€‚è¦æƒ³å†æ¬¡è¿æ¥ï¼Œæˆ–è€…è¯´è®©å¤šä¸ªå¥—æ¥å­—ç»‘å®šåœ¨åŒä¸€ç«¯å£ï¼Œå¯ä»¥é€šè¿‡socket.setsockoptå‡½æ•°æ¥å®ç°ã€‚","text":"å¯é‡ç”¨å¥—æ¥å­—å½“è¿æ¥è¢«æœ‰æ„æ— æ„å…³é—­æ—¶ï¼Œä½†æ­¤æ—¶ç«¯å£è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œè¦ç»è¿‡ä¸€ä¸ªTIME_WAITçš„è¿‡ç¨‹ä¹‹åæ‰èƒ½ä½¿ç”¨ã€‚è¦æƒ³å†æ¬¡è¿æ¥ï¼Œæˆ–è€…è¯´è®©å¤šä¸ªå¥—æ¥å­—ç»‘å®šåœ¨åŒä¸€ç«¯å£ï¼Œå¯ä»¥é€šè¿‡socket.setsockoptå‡½æ•°æ¥å®ç°ã€‚123456789import sockets = socket.socket(socket.AF_INET,socket.SOCK_STREAM)oldstatus = s.getsockopt(socket.SOL_SOCKET,socket.SO_REUSEADDR)#æ‰“å°æ—§çš„åœ°å€å¯é‡ç”¨çŠ¶æ€print(\"old address status:\",oldstatus)s.setsockopt(socket.SOL_SOCKET,socket.SO_REUSEADDR,1)newstatus = s.getsockopt(socket.SOL_SOCKET,socket.SO_REUSEADDR)#æ‰“å°æ–°çš„åœ°å€å¯é‡ç”¨çŠ¶æ€print(\"new address status:%s\" %newstatus) ç»“æœï¼š 123old address status: 0new address status:1[Finished in 0.0s] ä¿®æ”¹å¥—æ¥å­—å‘é€å’Œæ¥æ”¶çš„ç¼“å­˜åŒºå¤§å°ä»£ç ï¼š 1234567891011121314import socketSEND_BUF_SIZE = 4096RECV_BUF_SIZE = 4096def changeBufSize(): s = socket.socket(socket.AF_INET,socket.SOCK_STREAM) bufsize = s.getsockopt(socket.SOL_SOCKET,socket.SO_SNDBUF) print(\"buffer size before change:\",bufsize) s.setsockopt(socket.SOL_TCP,socket.TCP_NODELAY,1) s.setsockopt(socket.SOL_SOCKET,socket.SO_SNDBUF,SEND_BUF_SIZE) s.setsockopt(socket.SOL_SOCKET,socket.SO_RCVBUF,RECV_BUF_SIZE) bufsize2 = s.getsockopt(socket.SOL_SOCKET,socket.SO_SNDBUF) print('buffer size after change:',bufsize2)if __name__ == '__main__': changeBufSize() ç»“æœï¼š 12buffer size before change: 16384buffer size after change: 8192","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]},{"title":"Ubuntuå¼€æœºè‡ªåŠ¨æŒ‚è½½windowsçš„åˆ†åŒº","slug":"Ubuntuå¼€æœºè‡ªåŠ¨æŒ‚è½½windowsçš„åˆ†åŒº","date":"2016-06-03T14:26:03.000Z","updated":"2018-03-16T14:29:36.000Z","comments":true,"path":"2016/06/03/Ubuntuå¼€æœºè‡ªåŠ¨æŒ‚è½½windowsçš„åˆ†åŒº/","link":"","permalink":"http://yoursite.com/2016/06/03/Ubuntuå¼€æœºè‡ªåŠ¨æŒ‚è½½windowsçš„åˆ†åŒº/","excerpt":"ç”µè„‘è£…çš„æ˜¯ubuntuå’Œwin10åŒç³»ç»Ÿ.è£…ubuntuçš„æ—¶å€™ç»™ubuntuåˆ†é…çš„ç£ç›˜å°äº†,æœ€è¿‘å‘ç°æœ‰ç‚¹ä¸å¤Ÿç”¨.äºæ˜¯æƒ³ç€ä»windowæ‹¿å‡ºä¸€å—ç›˜æ¥ç»™linuxç”¨.æŸ¥æ‰¾èµ„æ–™,æœ€åæŠ˜è…¾æˆåŠŸå•¦.è®°å½•ä¸€ä¸‹è¿‡ç¨‹.","text":"ç”µè„‘è£…çš„æ˜¯ubuntuå’Œwin10åŒç³»ç»Ÿ.è£…ubuntuçš„æ—¶å€™ç»™ubuntuåˆ†é…çš„ç£ç›˜å°äº†,æœ€è¿‘å‘ç°æœ‰ç‚¹ä¸å¤Ÿç”¨.äºæ˜¯æƒ³ç€ä»windowæ‹¿å‡ºä¸€å—ç›˜æ¥ç»™linuxç”¨.æŸ¥æ‰¾èµ„æ–™,æœ€åæŠ˜è…¾æˆåŠŸå•¦.è®°å½•ä¸€ä¸‹è¿‡ç¨‹.windowä¸‹çš„æ–‡ä»¶ç³»ç»Ÿç°åœ¨ä¸€èˆ¬æ˜¯ntfs.åœ¨linuxå…¶å®æ˜¯å¯ä»¥è®¿é—®çš„.ä½†æ„Ÿè§‰ç”¨èµ·æ¥æœ‰äº›ä¸æ–¹ä¾¿.å…ˆå°±æ˜¯æŠŠwindowä¸‹æŸä¸ªç›˜å¦‚eç›˜(é€‰eç›˜å› ä¸ºæ²¡æœ‰åœ¨eç›˜è£…ä»»ä½•è½¯ä»¶)çš„ä¸œè¥¿å…¨éƒ¨å¤‡ä»½ä¸€ä¸‹.å¯ä»¥å…¨éƒ¨å¤åˆ¶åˆ°åˆ«çš„ç›˜.ç„¶åæ ¼å¼åŒ–eç›˜.ç‚¹å‡»æˆ‘çš„ç”µè„‘-&gt;ç®¡ç†-&gt;ç£ç›˜ç®¡ç†.æ‰¾åˆ°eåˆ†åŒº.å³å‡»åˆ é™¤å·.å°±æŠŠntfsæ–‡ä»¶ç³»ç»Ÿç»™åˆ äº†.ç„¶åå›åˆ°ubuntuä¸­. è¿™æ—¶å€™éœ€è¦ç”¨åˆ°ä¸€ä¸ªå·¥å…·,Gparted Partition Editor. åœ¨ubuntu software centeræœç´¢å®‰è£…å³å¯.æ‰“å¼€é¡µé¢æ˜¯è¿™æ ·å­çš„. æ‰¾åˆ°åˆšæ‰åˆ é™¤çš„é‚£å—ç›˜.æ ¹æ®ç›˜çš„å¤§å°å°±çŸ¥é“å•¦.ç„¶åå³å‡»-&gt;newæ–°å»ºä¸€ä¸ªç›˜â€¦æ“ä½œå®Œæˆåç‚¹é‚£ä¸ªå‹¾apply all operations.å°±å¯ä»¥å•¦.å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–°çš„åˆ†åŒº.æˆ‘çš„æ˜¯/dev/sda 15. åæ¥å‘ç°ä¸Šé¢çš„æ­¥éª¤æ›´ç®€å•.å¤‡ä»½æ•°æ®å,ç›´æ¥ç”¨Gpartedå°±å¯ä»¥æ ¼å¼è¯å’Œformat to ext4å•¦.ä¸éœ€è¦åˆ é™¤å·å•¥çš„. æ¥ä¸‹æ¥å°±æ˜¯æŠŠè¿™ä¸ªåˆ†åŒºæŒ‚è½½å•¦.æˆ‘é€‰æ‹©çš„æ˜¯åœ¨ /mntä¸‹æ–°å»ºä¸€ä¸ªç›®å½•wine ç„¶åæŠŠç›˜æŒ‚è½½åˆ°è¿™ä¸ªç›®å½•ä¸‹.. é€šè¿‡blkidå‘½ä»¤å¯ä»¥å¾—åˆ°/dev/sda15 è¿™æ ·çš„ä¿¡æ¯/dev/sda15: UUID=â€d05d23e1-ca9c-456d-b888-9cc3a0c5c627â€ TYPE=â€ext4â€å¤åˆ¶UUID.ç„¶åvi /etc/fstab ç¼–è¾‘é…ç½®ä¿¡æ¯.åœ¨åé¢è¿½åŠ :æˆ‘çš„æ˜¯: ä¿å­˜é€€å‡ºå.mount -a å°±ä¼šæ ¹æ®é…ç½®æ–‡ä»¶è‡ªåŠ¨æŒ‚è½½å•¦.è€Œä¸”å¼€æœºé‡å¯åä¹Ÿä¸éœ€è¦é‡æ–°æŒ‚è½½.å½“ç„¶ä¸­é—´é‡åˆ°äº†ä¸€äº›é—®é¢˜.å¦‚æŸ¥çœ‹åˆ†åŒºæƒ…å†µfdisk -l ä¼šæŠ¥é”™:WARNING: GPT (GUID Partition Table) detected on â€˜/dev/sdaâ€™! The util fdisk doesnâ€™t support GPT. Use GNU Parted.æ‰€ä»¥è¿™ä¸ªsdaå°±æ˜¯gptçš„ã€‚çœ‹gptåˆ†åŒºè¯¦ç»†å†…å®¹å¯ç”¨partedï¼Œå¦‚ï¼šparted -l.è¿˜æœ‰æ¶‰åŠåˆ°æŒ‚è½½æ—¶åˆ†åŒºçš„æƒé™.å’Œé»˜è®¤ç¼–ç ç­‰é—®é¢˜.","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]},{"title":"socketserveræºç å­¦ä¹ ä¹‹å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹Mixin","slug":"socketserveræºç å­¦ä¹ ä¹‹å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹Mixin","date":"2016-05-08T14:42:13.000Z","updated":"2018-03-16T14:45:11.000Z","comments":true,"path":"2016/05/08/socketserveræºç å­¦ä¹ ä¹‹å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹Mixin/","link":"","permalink":"http://yoursite.com/2016/05/08/socketserveræºç å­¦ä¹ ä¹‹å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹Mixin/","excerpt":"æœ€è¿‘çœ‹pythonæ ‡å‡†åº“socketserveræ—¶ï¼Œå‘ç°ä½¿ç”¨MixInæœºåˆ¶ï¼Œé€šè¿‡è‡ªå®šä¹‰TCPServeræˆ–UDPServeræ—¶ï¼Œç»§æ‰¿ä¸€ä¸ªsocketserver.ThreadingMixInç±»æˆ–æ˜¯socketserver.ForkingMixInç±»ä¾¿å¯å¢åŠ å¯¹è¯·æ±‚çš„å¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹å¤„ç†ã€‚å°±åƒè¿™æ ·","text":"æœ€è¿‘çœ‹pythonæ ‡å‡†åº“socketserveræ—¶ï¼Œå‘ç°ä½¿ç”¨MixInæœºåˆ¶ï¼Œé€šè¿‡è‡ªå®šä¹‰TCPServeræˆ–UDPServeræ—¶ï¼Œç»§æ‰¿ä¸€ä¸ªsocketserver.ThreadingMixInç±»æˆ–æ˜¯socketserver.ForkingMixInç±»ä¾¿å¯å¢åŠ å¯¹è¯·æ±‚çš„å¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹å¤„ç†ã€‚å°±åƒè¿™æ · 12class ThreadedTCPServer(socketserver.ForkingMixIn, socketserver.TCPServer): pass éå¸¸çš„æ–¹ä¾¿ã€‚ æºç ä¸­å¯¹å¤šçº¿ç¨‹çš„å®ç°æ¯”è¾ƒå®¹æ˜“æ‡‚ï¼Œé€šè¿‡å¯¹æ¯ä¸ªè¯·æ±‚å¼€ä¸€ä¸ªçº¿ç¨‹å»å¤„ç†ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456def process_request(self, request, client_address): \"\"\"Start a new thread to process the request.\"\"\" t = threading.Thread(target = self.process_request_thread, args = (request, client_address)) t.daemon = self.daemon_threads t.start() å¤šè¿›ç¨‹çš„å®ç°é‡‡å–çš„ä¸æ˜¯multiprocessingæ¨¡å—ï¼Œè€Œæ˜¯é€šè¿‡osæ¨¡å—çš„forkå‡½æ•°æ¥äº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ï¼ˆåœ¨Unix/linuxä¸‹ï¼Œwindowsç³»ç»Ÿä¸æä¾›forkå‡½æ•°ï¼Œåªèƒ½é€šè¿‡multiprocessingæ¨¡å—æ¥å®ç°å¤šè¿›ç¨‹ï¼‰ï¼Œé€šè¿‡å­è¿›ç¨‹å¯¹æ–°çš„è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚ os.fork()å…ˆæ¥çœ‹çœ‹osæ¨¡å—çš„forkå‡½æ•°å§ï¼ŒUnix/Linuxæ“ä½œç³»ç»Ÿæä¾›äº†ä¸€ä¸ªfork()ç³»ç»Ÿè°ƒç”¨ï¼Œå®ƒè™½è¯´ä¹Ÿæ˜¯å‡½æ•°ï¼Œå’Œæ™®é€šå‡½æ•°å´æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œæ™®é€šå‡½æ•°è°ƒç”¨ä¸€æ¬¡ï¼Œè¿”å›ä¸€æ¬¡ï¼Œä½†æ˜¯fork()å‡½æ•°è°ƒç”¨ä¸€æ¬¡ï¼Œè¿”å›ä¸¤æ¬¡ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿè‡ªåŠ¨æŠŠå½“å‰è¿›ç¨‹ï¼ˆç§°ä¸ºçˆ¶è¿›ç¨‹ï¼‰å¤åˆ¶äº†ä¸€ä»½ï¼ˆç§°ä¸ºå­è¿›ç¨‹ï¼‰ï¼Œç„¶åï¼Œåˆ†åˆ«åœ¨çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å†…è¿”å›ã€‚ å­è¿›ç¨‹æ°¸è¿œè¿”å›0ï¼Œè€Œçˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹çš„IDã€‚è¿™æ ·åšçš„ç†ç”±æ˜¯ï¼Œä¸€ä¸ªçˆ¶è¿›ç¨‹å¯ä»¥forkå‡ºå¾ˆå¤šå­è¿›ç¨‹ï¼Œæ‰€ä»¥ï¼Œçˆ¶è¿›ç¨‹è¦è®°ä¸‹æ¯ä¸ªå­è¿›ç¨‹çš„IDï¼Œè€Œå­è¿›ç¨‹åªéœ€è¦è°ƒç”¨getppid()å°±å¯ä»¥æ‹¿åˆ°çˆ¶è¿›ç¨‹çš„IDã€‚ ä¾‹å­ï¼š 1234567import osprint('Process (%s) start...' % os.getpid())pid = os.fork()if pid == 0: print('I am child process (%s) and my parent is %s.' % (os.getpid(), os.getppid()))else: print('I am parent process (%s) child process (%s) is my child' % (os.getpid(), pid)) socketserveræ¨¡å—ä¸­ï¼Œå½“ä¸€ä¸ªæ–°çš„è¯·æ±‚å‘ç”Ÿæ—¶ï¼Œé€šè¿‡è°ƒç”¨os.fork()ï¼Œå½“å‰è¿›ç¨‹äº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ã€‚ç„¶åé€šè¿‡å­è¿›ç¨‹ï¼ˆpidä¸º0)å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œæºä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223def process_request(self, request, client_address): \"\"\"Fork a new subprocess to process the request.\"\"\" pid = os.fork() if pid: # Parent process if self.active_children is None: self.active_children = set() self.active_children.add(pid) self.close_request(request) return else: # Child process. # This must never return, hence os._exit()! try: self.finish_request(request, client_address) self.shutdown_request(request) os._exit(0) except: try: self.handle_error(request, client_address) self.shutdown_request(request) finally: os._exit(1) åœ¨å­è¿›ç¨‹ä¸­å¤„ç†æ–°çš„è¿æ¥è¯·æ±‚ï¼Œçˆ¶è¿›ç¨‹åˆ™éœ€è¦è®°å½•è‡ªå·±äº§ç”Ÿçš„å­è¿›ç¨‹ï¼Œå°†å­è¿›ç¨‹çš„è¿›ç¨‹å·æ·»åŠ åˆ°ä¸€ä¸ªé›†åˆä¸­ï¼Œæ–¹ä¾¿æ¥ä¸‹æ¥å¤„ç†ï¼Œå½“å­è¿›ç¨‹ç»“æŸåï¼Œçˆ¶è¿›ç¨‹è°ƒç”¨wait/waitpidå‡½æ•°æ¥é‡Šæ”¾å­è¿›ç¨‹é—ç•™åœ¨ç³»ç»Ÿä¸­çš„ä¿¡æ¯ã€‚è¿™é‡Œåˆæ¶‰åŠåˆ°åƒµå°¸è¿›ç¨‹å’Œå­¤å„¿è¿›ç¨‹çš„ç›¸å…³çŸ¥è¯†ï¼Œç½‘ä¸ŠæŸ¥æ‰¾ä¸€ç•ªåï¼Œæ‰çŸ¥é“ä¸¤è€…æ˜¯ä»€ä¹ˆã€‚ä¸æ˜¯è®¡ç®—æœºä¸“ä¸šå‡ºèº«ï¼Œæœç„¶ç›¸å…³çŸ¥è¯†å¾ˆæ¬ ç¼ºã€‚ åƒµå°¸è¿›ç¨‹ï¼šä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨forkåˆ›å»ºå­è¿›ç¨‹ï¼Œå¦‚æœå­è¿›ç¨‹é€€å‡ºï¼Œè€Œçˆ¶è¿›ç¨‹å¹¶æ²¡æœ‰è°ƒç”¨waitæˆ–waitpidè·å–å­è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ï¼Œé‚£ä¹ˆå­è¿›ç¨‹çš„è¿›ç¨‹æè¿°ç¬¦ä»ç„¶ä¿å­˜åœ¨ç³»ç»Ÿä¸­ã€‚è¿™ç§è¿›ç¨‹ç§°ä¹‹ä¸ºåƒµæ­»è¿›ç¨‹ã€‚åœ¨UNIXä¸­,æ¯ä¸ªè¿›ç¨‹é€€å‡ºæ—¶ï¼Œå†…æ ¸é‡Šæ”¾è¯¥è¿›ç¨‹çš„æ‰€æœ‰èµ„æºï¼ŒåŒ…æ‹¬æ‰“å¼€çš„æ–‡ä»¶ï¼Œå ç”¨çš„å†…å­˜ç­‰ï¼Œ ä½†æ˜¯ä»ç„¶ä¸ºå…¶ä¿ç•™ä¸€å®šçš„ä¿¡æ¯(åŒ…æ‹¬è¿›ç¨‹å·the process ID,é€€å‡ºçŠ¶æ€the termination status of the process,è¿è¡Œæ—¶é—´the amount of CPU time taken by the processç­‰)ã€‚ç›´åˆ°çˆ¶è¿›ç¨‹é€šè¿‡wait / waitpidæ¥å–æ—¶æ‰é‡Šæ”¾ã€‚ ä½†è¿™æ ·å°±å¯¼è‡´äº†é—®é¢˜ï¼Œå¦‚æœè¿›ç¨‹ä¸è°ƒç”¨wait / waitpidçš„è¯ï¼Œ é‚£ä¹ˆä¿ç•™çš„é‚£æ®µä¿¡æ¯å°±ä¸ä¼šé‡Šæ”¾ï¼Œå…¶è¿›ç¨‹å·å°±ä¼šä¸€ç›´è¢«å ç”¨ï¼Œä½†æ˜¯ç³»ç»Ÿæ‰€èƒ½ä½¿ç”¨çš„è¿›ç¨‹å·æ˜¯æœ‰é™çš„ï¼Œå¦‚æœå¤§é‡çš„äº§ç”Ÿåƒµæ­»è¿›ç¨‹ï¼Œå°†å› ä¸ºæ²¡æœ‰å¯ç”¨çš„è¿›ç¨‹å·è€Œå¯¼è‡´ç³»ç»Ÿä¸èƒ½äº§ç”Ÿæ–°çš„è¿›ç¨‹ï¼Œæ­¤å³ä¸ºåƒµå°¸è¿›ç¨‹çš„å±å®³ï¼Œåº”å½“é¿å…ã€‚ å­¤å„¿è¿›ç¨‹ï¼šä¸€ä¸ªçˆ¶è¿›ç¨‹é€€å‡ºï¼Œè€Œå®ƒçš„ä¸€ä¸ªæˆ–å¤šä¸ªå­è¿›ç¨‹è¿˜åœ¨è¿è¡Œï¼Œé‚£ä¹ˆé‚£äº›å­è¿›ç¨‹å°†æˆä¸ºå­¤å„¿è¿›ç¨‹ã€‚å­¤å„¿è¿›ç¨‹å°†è¢«initè¿›ç¨‹(è¿›ç¨‹å·ä¸º1)æ‰€æ”¶å…»ï¼Œå¹¶ç”±initè¿›ç¨‹å¯¹å®ƒä»¬å®ŒæˆçŠ¶æ€æ”¶é›†å·¥ä½œã€‚å­¤å„¿è¿›ç¨‹æ˜¯æ²¡æœ‰çˆ¶è¿›ç¨‹çš„è¿›ç¨‹ï¼Œinitè¿›ç¨‹å°±æˆäº†å­¤å„¿è¿›ç¨‹çš„ç»§çˆ¶ï¼Œå½“å­¤å„¿è¿›ç¨‹å‡ºç°æ—¶ï¼Œå†…æ ¸å°±æŠŠå­¤å„¿è¿›ç¨‹çš„çˆ¶è¿›ç¨‹è®¾ç½®ç¨‹initï¼Œè€Œinitè¿›ç¨‹ä¼šå¾ªç¯çš„wait()å®ƒçš„å·²ç»é€€å‡ºçš„å­è¿›ç¨‹ï¼Œ åœ¨socketserverä¸­ï¼Œäº§ç”Ÿå­è¿›ç¨‹æ—¶ï¼Œä¾¿ä¼šå°†å­è¿›ç¨‹è®°å½•åˆ°ä¸€ä¸ªé›†åˆä¸­ï¼Œå­è¿›ç¨‹ç»“æŸæ—¶ï¼Œç›¸å½“äºç³»ç»Ÿä¸­å¤šäº†ä¸€ä¸ªåƒµå°¸è¿›ç¨‹ï¼Œsocketserveré€šè¿‡collect_childrenå‡½æ•°æ¥å¤„ç†è¿™æ—¶å€™åƒµå°¸è¿›ç¨‹ã€‚æºä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334max_children=40def collect_children(self): \"\"\"Internal routine to wait for children that have exited.\"\"\" if self.active_children is None: return # If we're above the max number of children, wait and reap them until # we go back below threshold. Note that we use waitpid(-1) below to be # able to collect children in size(&lt;defunct children&gt;) syscalls instead # of size(&lt;children&gt;): the downside is that this might reap children # which we didn't spawn, which is why we only resort to this when we're # above max_children. while len(self.active_children) &gt;= self.max_children: try: pid, _ = os.waitpid(-1, 0) self.active_children.discard(pid) except InterruptedError: pass except ChildProcessError: # we don't have any children, we're done self.active_children.clear() except OSError: break # Now reap all defunct children. for pid in self.active_children.copy(): try: pid, _ = os.waitpid(pid, os.WNOHANG) # if the child hasn't exited yet, pid will be 0 and ignored by # discard() below self.active_children.discard(pid) except ChildProcessError: # someone else reaped it self.active_children.discard(pid) except OSError: pass è¿™é‡Œæœ‰æ¶‰åŠåˆ°os.waitpidå‡½æ•°çš„ä½¿ç”¨ï¼Œ os.waitid(idtype, id, options)ç­‰å¾…è¿›ç¨‹idä¸ºpidçš„è¿›ç¨‹ç»“æŸï¼Œè¿”å›ä¸€ä¸ªtupleï¼ŒåŒ…æ‹¬è¿›ç¨‹çš„è¿›ç¨‹IDå’Œé€€å‡ºä¿¡æ¯(å’Œos.wait()ä¸€æ ·)ï¼Œå‚æ•°optionsä¼šå½±å“è¯¥å‡½æ•°çš„è¡Œä¸ºã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œoptionsçš„å€¼ä¸º0ã€‚å¦‚æœpidæ˜¯ä¸€ä¸ªæ­£æ•°ï¼Œwaitpid()è¯·æ±‚è·å–ä¸€ä¸ªpidæŒ‡å®šçš„è¿›ç¨‹çš„é€€å‡ºä¿¡æ¯ï¼Œå¦‚æœpidä¸º0ï¼Œåˆ™ç­‰å¾…å¹¶è·å–å½“å‰è¿›ç¨‹ç»„ä¸­çš„ä»»ä½•å­è¿›ç¨‹çš„å€¼ã€‚å¦‚æœpidä¸º-1ï¼Œåˆ™ç­‰å¾…å½“å‰è¿›ç¨‹çš„ä»»ä½•å­è¿›ç¨‹(ç›¸å½“äºos.wait())ï¼Œå¦‚æœpidå°äº-1ï¼Œåˆ™è·å–è¿›ç¨‹ç»„idä¸ºpidçš„ç»å¯¹å€¼çš„ä»»ä½•ä¸€ä¸ªè¿›ç¨‹ã€‚å½“ç³»ç»Ÿè°ƒç”¨è¿”å›-1æ—¶ï¼ŒæŠ›å‡ºä¸€ä¸ªOSErrorå¼‚å¸¸ã€‚ waitpid()å‡½æ•°çš„optionsé€‰é¡¹ï¼š os.WNOHANG - å¦‚æœæ²¡æœ‰å­è¿›ç¨‹é€€å‡ºï¼Œåˆ™ä¸é˜»å¡waitpid()è°ƒç”¨ os.WCONTINUED - å¦‚æœå­è¿›ç¨‹ä»stopçŠ¶æ€å˜ä¸ºç»§ç»­æ‰§è¡Œï¼Œåˆ™è¿”å›è¿›ç¨‹è‡ªå‰ä¸€æ¬¡æŠ¥å‘Šä»¥æ¥çš„ä¿¡æ¯ã€‚ os.WUNTRACED - å¦‚æœå­è¿›ç¨‹è¢«åœæ­¢è¿‡è€Œä¸”å…¶çŠ¶æ€ä¿¡æ¯è¿˜æ²¡æœ‰æŠ¥å‘Šè¿‡ï¼Œåˆ™æŠ¥å‘Šå­è¿›ç¨‹çš„ä¿¡æ¯","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]},{"title":"collectionsæ¨¡å—å­¦ä¹ æ€»ç»“","slug":"collectionsæ¨¡å—å­¦ä¹ æ€»ç»“","date":"2016-03-16T14:19:03.000Z","updated":"2018-03-16T14:29:48.000Z","comments":true,"path":"2016/03/16/collectionsæ¨¡å—å­¦ä¹ æ€»ç»“/","link":"","permalink":"http://yoursite.com/2016/03/16/collectionsæ¨¡å—å­¦ä¹ æ€»ç»“/","excerpt":"Pythonå†…ç½®çš„æ•°æ®ç±»å‹å¦‚list,tupple,dictå·²ç»éå¸¸å¼ºå¤§å•¦,ä»Šå¤©å‘ç°ä¸€ä¸ªæ›´å¼ºå¤§çš„æ ‡å‡†åº“:collectionsåœ¨åŸæ¥çš„åŸºç¡€ä¸Šæœ‰æ·»åŠ äº†å‡ ç§é¢å¤–çš„æ•°æ®ç±»å‹: Counter:è®¡æ•°å™¨,dictçš„å­ç±» deque:åŒç«¯é˜Ÿåˆ—,å¯ä»¥å¿«é€Ÿçš„ä»é¦–å°¾appendå’Œpop","text":"Pythonå†…ç½®çš„æ•°æ®ç±»å‹å¦‚list,tupple,dictå·²ç»éå¸¸å¼ºå¤§å•¦,ä»Šå¤©å‘ç°ä¸€ä¸ªæ›´å¼ºå¤§çš„æ ‡å‡†åº“:collectionsåœ¨åŸæ¥çš„åŸºç¡€ä¸Šæœ‰æ·»åŠ äº†å‡ ç§é¢å¤–çš„æ•°æ®ç±»å‹: Counter:è®¡æ•°å™¨,dictçš„å­ç±» deque:åŒç«¯é˜Ÿåˆ—,å¯ä»¥å¿«é€Ÿçš„ä»é¦–å°¾appendå’Œpop Counterå¯¹è±¡Counteræ˜¯ä¸€ä¸ªdictçš„å­ç±»,å®ƒä¹Ÿæ˜¯æ— åºå­˜å‚¨,å…ƒç´ ä½œä¸ºå­—å…¸çš„keys,å…ƒç´ ä¸ªæ•°ä½œä¸ºå­—å…¸çš„valueå­˜å‚¨åº”ç”¨: 123456&gt;&gt;&gt; m = ['red','yellow','red','red','blue'] &gt;&gt;&gt; c = Counter(m) &gt;&gt;&gt; c Counter(&#123;'red': 3, 'yellow': 1, 'blue': 1&#125;) &gt;&gt;&gt; c['red'] 3 Counterçš„ä¸‰ç§ç‰¹æœ‰æ–¹æ³•:elements()è¿”å›ä¸€ä¸ªåˆ—ä¸¾æ‰€æœ‰å…ƒç´ çš„è¿­ä»£å™¨,ä¸Šä»£ç : 1234&gt;&gt;&gt; c = Counter(a=4, b=2, c=0, d=-2) &gt;&gt;&gt; list(c.elements())['a', 'a', 'a', 'a', 'b', 'b']most_common([n]) åˆ—å‡ºè®¡æ•°æœ€å¤§çš„nä¸ªå…ƒç´  12345&gt;&gt;&gt; Counter('abracadabra').most_common(3)[('a', 5), ('r', 2), ('b', 2)]&gt;&gt;&gt; Counter('abracadabra').most_common(4)[('a', 5), ('r', 2), ('b', 2), ('c', 1)]subtract([iterable-or-mapping]) å…ƒç´ è¢«æ‰£é™¤,ä»ä¸€ä¸ªè¿­ä»£å™¨æˆ–å¦å¤–ä¸€ä¸ªmappingæˆ–è®¡æ•°å™¨,æœ‰ç‚¹åƒdictçš„update(),ä½†ä¸æ˜¯é‚£æ ·å–ä»£å…ƒç´  12345&gt;&gt;&gt; c = Counter(a=4, b=2, c=0, d=-2) &gt;&gt;&gt; d = Counter(a=1, b=2, c=3, d=4) &gt;&gt;&gt; c.subtract(d) &gt;&gt;&gt; c Counter(&#123;'a': 3, 'b': 0, 'c': -3, 'd': -6&#125;) å½“ç„¶Counteræ˜¯dictçš„å­ç±»,è‡ªç„¶ä¹Ÿæ”¯æŒdictçš„é‚£äº›æ–¹æ³•å’¯ dequeç±»å…¨ç§°:â€œdouble-ended queueâ€ è¯´ç™½äº†å°±æ˜¯åŒç«¯é˜Ÿåˆ—,å¯ä»¥åœ¨å¤´å°¾éƒ½è¿›è¡Œæ·»åŠ å’Œåˆ é™¤å°½ç®¡listä¹Ÿæ”¯æŒç±»ä¼¼çš„æ“ä½œ:å¦‚ pop(0)å’Œ insert(0,v)ä½†ä¸¤è€…çš„æ—¶é—´å¤æ‚åº¦ä¸ä¸€æ ·,listè¿™æ ·çš„æ“ä½œæ˜¯O(n),è€Œdequeä¸ºO(1) æ–¹æ³•:append(x) æœ«å°¾æ·»åŠ appendleft(x) é¦–éƒ¨æ·»åŠ clear() åˆ é™¤æ‰€æœ‰å…ƒç´ count(x) ç»Ÿè®¡xçš„ä¸ªæ•°extend(iterable) åœ¨dequeå³è¾¹æ‰©å±•,ä»itableä¸­æ·»åŠ å…ƒç´ extendleft(iterable) åŒç†pop()popleft()reverse()åè½¬remove(value) ä¸€å¤„ç¬¬ä¸€ä¸ªå‡ºç°çš„value,åé¢çš„valueä¿ç•™rotate(n) è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒç‰¹æ®Š,å°†dequeå¾€å³ç§»nä½ å¦‚æœnä¸ºè´Ÿ,åˆ™ä¸ºå·¦ç§»deque(maxlen=10) é™åˆ¶åŒç«¯é˜Ÿåˆ—çš„é•¿åº¦,å½“æ»¡äº†çš„æ—¶å€™å†æ·»åŠ ,æœ€è€çš„å…ƒç´ ä¼šè¢«åˆ é™¤,æ–°å…ƒç´ æ·»åŠ è¿›æ¥ ä¸¾ä¸ªæ —å­ 123456789101112131415161718192021222324252627282930313233343536373839404142434445&gt;&gt;&gt; from collections import deque&gt;&gt;&gt; d = deque('ghi') # make a new deque with three items&gt;&gt;&gt; for elem in d: # iterate over the deque's elements... print elem.upper()GHI&gt;&gt;&gt; d.append('j') # add a new entry to the right side&gt;&gt;&gt; d.appendleft('f') # add a new entry to the left side&gt;&gt;&gt; d # show the representation of the dequedeque(['f', 'g', 'h', 'i', 'j'])&gt;&gt;&gt; d.pop() # return and remove the rightmost item'j'&gt;&gt;&gt; d.popleft() # return and remove the leftmost item'f'&gt;&gt;&gt; list(d) # list the contents of the deque['g', 'h', 'i']&gt;&gt;&gt; d[0] # peek at leftmost item'g'&gt;&gt;&gt; d[-1] # peek at rightmost item'i'&gt;&gt;&gt; list(reversed(d)) # list the contents of a deque in reverse['i', 'h', 'g']&gt;&gt;&gt; 'h' in d # search the dequeTrue&gt;&gt;&gt; d.extend('jkl') # add multiple elements at once&gt;&gt;&gt; ddeque(['g', 'h', 'i', 'j', 'k', 'l'])&gt;&gt;&gt; d.rotate(1) # right rotation&gt;&gt;&gt; ddeque(['l', 'g', 'h', 'i', 'j', 'k'])&gt;&gt;&gt; d.rotate(-1) # left rotation&gt;&gt;&gt; ddeque(['g', 'h', 'i', 'j', 'k', 'l'])&gt;&gt;&gt; deque(reversed(d)) # make a new deque in reverse orderdeque(['l', 'k', 'j', 'i', 'h', 'g'])&gt;&gt;&gt; d.clear() # empty the deque&gt;&gt;&gt; d.pop() # cannot pop from an empty dequeTraceback (most recent call last): File \"&lt;pyshell#6&gt;\", line 1, in -toplevel- d.pop()IndexError: pop from an empty deque&gt;&gt;&gt; d.extendleft('abc') # extendleft() reverses the input order&gt;&gt;&gt; ddeque(['c', 'b', 'a'])","categories":[],"tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://yoursite.com/tags/ç¼–ç¨‹/"}]}]}